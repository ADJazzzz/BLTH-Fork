// ==UserScript==
// @name            Bilibili Live Tasks Helper Fork
// @name:en         Bilibili Live Tasks Helper Fork
// @name:zh         Bilibili Live Tasks Helper Fork
// @namespace       https://github.com/ADJazzzz
// @version         7.1.2-001
// @author          andywang425 & ADJazzzz
// @description     Enhancing the experience of watching Bilibili live streaming.
// @description:en  Enhancing the experience of watching Bilibili live streaming.
// @description:zh  Enhancing the experience of watching Bilibili live streaming.
// @license         MIT
// @copyright       2023, andywang425 (https://github.com/andywang425)
// @icon            data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDEuMDY1IiBoZWlnaHQ9IjEyNy43NDciIHZpZXdCb3g9IjAgMCAzNy4zMjQgMzMuOCI+PHBhdGggZmlsbD0iIzIwYjBlMyIgZD0iTTg2Ljk2MiAxMTIuMzMyYTIuNjYxIDIuNjYxIDAgMCAxIDIuMjYyIDAgNS41MzYgNS41MzYgMCAwIDEgMS4zODQgMS4wMTFsNS4zMjMgNC42NThoMy44MDVsNS4zMjMtNC42NThhNS41ODkgNS41ODkgMCAwIDEgMS4zODQtMS4wMTEgMi42NjEgMi42NjEgMCAwIDEgMy41NCAyLjIwOSAyLjY2MSAyLjY2MSAwIDAgMS0uNTg2IDEuNzgzIDE0Ljg3NyAxNC44NzcgMCAwIDEtMS4xNzEgMS4wNjUgNy42OTEgNy42OTEgMCAwIDEtLjc0NS42MTJoMy4zMjZhNS42NDIgNS42NDIgMCAwIDEgMy45MTIgMS43NTYgNS42NjkgNS42NjkgMCAwIDEgMS43ODQgMy45MTJ2MTUuMzAzYTEwLjc3OCAxMC43NzggMCAwIDEtLjEzNCAyLjMxNSA1LjkwOCA1LjkwOCAwIDAgMS0yLjY2IDMuNzI2IDUuNzIyIDUuNzIyIDAgMCAxLTMuMDYxLjg1Mkg4Ni4yMTdhMTEuMjg0IDExLjI4NCAwIDAgMS0yLjM5Ni0uMTMzIDUuODgyIDUuODgyIDAgMCAxLTMuNjcyLTIuNjYyIDUuNjk1IDUuNjk1IDAgMCAxLS45MDUtMy4wNnYtMTUuMTQzYTExLjkyMyAxMS45MjMgMCAwIDEgMC0yLjIwOSA1Ljg1NSA1Ljg1NSAwIDAgMSA1LjMyMy00LjczN2gzLjQ4NmMtLjU1OS0uNC0xLjAzOC0uODc4LTEuNTQ0LTEuMzA0YTIuNjYxIDIuNjYxIDAgMCAxLS44NTEtMi4xODMgMi42NjEgMi42NjEgMCAwIDEgMS4zMDQtMi4xMDJtLS42MTIgMTAuMzI2YTIuNjYxIDIuNjYxIDAgMCAwLTIuMTAzIDEuOTE2IDMuNTkzIDMuNTkzIDAgMCAwIDAgMS4wMTF2MTIuNTg4YTIuNjYxIDIuNjYxIDAgMCAwIDEuODM3IDIuNjYyIDMuNTEzIDMuNTEzIDAgMCAwIDEuMTQ0LjE4NmgyMS42MzdhMi42NjEgMi42NjEgMCAwIDAgMi41MjgtMS41NyAzLjcyNiAzLjcyNiAwIDAgMCAuMjY2LTEuNzU3di0xMS43MWE0LjQ3MSA0LjQ3MSAwIDAgMCAwLTEuMjc3IDIuNjYxIDIuNjYxIDAgMCAwLTEuNzMtMS44MSA0LjI4NSA0LjI4NSAwIDAgMC0xLjY1LS4yMzlIODcuNjAxYTguODg5IDguODg5IDAgMCAwLTEuMjUxIDB6bTAgMCIgc3R5bGU9InN0cm9rZS13aWR0aDouMDMzMDcyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTc5LjE5MyAtMTEyLjA4KSIvPjxwYXRoIGQ9Ik04OC45NyAxMjguNjM2Yy4zNjMuMzc3Ljc0NS43NDcgMS4wODggMS4xNDIuNTk3LjY4NyAxLjExOCAxLjE5NyAxLjY2NiAxLjgwOS0uMTI5LTEuMTE3IDEuMzA0LTEuMTk4LjA3NC0xLjc1Ny0uNDA4LjQxNy0uOTQxLjg4NC0xLjM2IDEuMjIzLS4zOTIuMzE2LS44NjMuNjctMS4yMzUuOTUyLTEuOTA3IDEuNDQzLjIyNiA0LjA1MyAyLjEzIDIuNjA3IDAgMCAyLTEuNTM1IDIuODA3LTIuMzAxLjQ0LS40MTcuNjgtLjk1Ni43Mi0xLjU5Mi4wNC0uNjU0LS41MzUtMS4yNC0uNzk0LTEuNDk4LS45Mi0uOTE0LTEuNzQzLTEuOTY4LTIuNTUtMi44MTItMS41NzUtMS44LTQuMTIuNDI4LTIuNTQ2IDIuMjI3ek0xMDYuOTc5IDEyOC42MzZjLS4zNjMuMzc3LS43NDUuNzQ3LTEuMDg4IDEuMTQyLS41OTcuNjg3LTEuMTE4IDEuMTk3LTEuNjY2IDEuODA5LjEyOS0xLjExNy0xLjMwNC0xLjE5OC0uMDc0LTEuNzU3LjQwOC40MTcuOTQxLjg4NCAxLjM2IDEuMjIzLjM5Mi4zMTYuODYzLjY3IDEuMjM1Ljk1MiAxLjkwNyAxLjQ0My0uMjI2IDQuMDUzLTIuMTMgMi42MDcgMCAwLTItMS41MzUtMi44MDctMi4zMDEtLjQ0LS40MTctLjY4LS45NTYtLjcyLTEuNTkyLS4wNC0uNjU0LjUzNS0xLjI0Ljc5NC0xLjQ5OC45Mi0uOTE0IDEuNzQzLTEuOTY4IDIuNTUtMi44MTIgMS41NzUtMS44IDQuMTIuNDI4IDIuNTQ2IDIuMjI3eiIgc3R5bGU9ImZpbGw6IzIwYjBlMztmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6LjUyNDE1OTtzdHJva2UtZGFzaGFycmF5Om5vbmUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC03OS4xOTMgLTExMi4wOCkiLz48L3N2Zz4NCg==
// @homepageURL     https://github.com/ADJazzzz/BLTH-Fork
// @supportURL      https://github.com/ADJazzzz/BLTH-Fork/issues
// @downloadURL     https://raw.githubusercontent.com/ADJazzzz/BLTH-Fork/main/dist/bilibili-live-tasks-helper.min.user.js
// @updateURL       https://raw.githubusercontent.com/ADJazzzz/BLTH-Fork/main/dist/bilibili-live-tasks-helper.min.user.js
// @match           *://live.bilibili.com/1*
// @match           *://live.bilibili.com/2*
// @match           *://live.bilibili.com/3*
// @match           *://live.bilibili.com/4*
// @match           *://live.bilibili.com/5*
// @match           *://live.bilibili.com/6*
// @match           *://live.bilibili.com/7*
// @match           *://live.bilibili.com/8*
// @match           *://live.bilibili.com/9*
// @match           *://live.bilibili.com/blanc/1*
// @match           *://live.bilibili.com/blanc/2*
// @match           *://live.bilibili.com/blanc/3*
// @match           *://live.bilibili.com/blanc/4*
// @match           *://live.bilibili.com/blanc/5*
// @match           *://live.bilibili.com/blanc/6*
// @match           *://live.bilibili.com/blanc/7*
// @match           *://live.bilibili.com/blanc/8*
// @match           *://live.bilibili.com/blanc/9*
// @require         https://unpkg.com/vue@3.3.4/dist/vue.global.prod.js
// @require         data:application/javascript,window.Vue%3DVue%2Cwindow.VueDemi%3DVue%3B
// @require         https://unpkg.com/element-plus@2.3.14/dist/index.full.min.js
// @require         https://unpkg.com/@element-plus/icons-vue@2.1.0/dist/index.iife.min.js
// @require         https://unpkg.com/pinia@2.1.6/dist/pinia.iife.prod.js
// @require         https://unpkg.com/lodash@4.17.21/lodash.min.js
// @require         https://unpkg.com/hotkeys-js@3.12.0/dist/hotkeys.min.js
// @require         https://unpkg.com/luxon@3.4.3/build/global/luxon.min.js
// @require         https://unpkg.com/crypto-js@4.1.1/crypto-js.js
// @resource        element-plus/dist/index.css  https://unpkg.com/element-plus@2.3.14/dist/index.css
// @connect         api.bilibili.com
// @connect         api.live.bilibili.com
// @connect         api.vc.bilibili.com
// @connect         passport.bilibili.com
// @connect         live.bilibili.com
// @connect         live-trace.bilibili.com
// @grant           GM_addStyle
// @grant           GM_getResourceText
// @grant           GM_getValue
// @grant           GM_setValue
// @grant           GM_xmlhttpRequest
// @grant           unsafeWindow
// @run-at          document-start
// ==/UserScript==
(e=>{if("function"==typeof GM_addStyle)return void GM_addStyle(e);const t=document.createElement("style");t.textContent=e,document.head.append(t)})(" .title[data-v-e675db5f]{padding-left:20px;align-items:center;display:flex}.header-big-text[data-v-e675db5f]{font-size:var(--big-text-size)}.header-small-text[data-v-e675db5f]{font-size:var(--small-text-size);padding-top:calc(var(--big-text-size) - var(--small-text-size));margin-left:10px;--small-text-size: 18px}.collapse-btn[data-v-e675db5f]{display:flex;justify-content:center;align-items:center;height:100%;float:left;cursor:pointer}.avatar-wrap[data-v-a6281aa6]{width:80px;height:80px}.avatar[data-v-a6281aa6]{display:flex;justify-content:center;align-items:center;border-radius:50%}.base[data-v-d9fcd727]{z-index:1003;position:absolute;background-color:#fff;border-bottom:1px solid #e3e5e7;border-left:1px solid #e3e5e7;border-right:1px solid #e3e5e7}.header[data-v-d9fcd727]{position:relative;box-sizing:border-box;width:100%;font-size:var(--big-text-size);align-items:center;display:flex;border-bottom:1px solid #e3e5e7;height:60px;--big-text-size: 25px}.aside[data-v-d9fcd727]{width:auto}.aside #aside-el-menu[data-v-d9fcd727]:not(.el-menu--collapse){width:150px}.main[data-v-d9fcd727]{--main-top-botton-padding: calc(var(--el-main-padding) * .625);padding-top:var(--main-top-botton-padding);padding-bottom:var(--main-top-botton-padding)}.fade-enter-active[data-v-d9fcd727],.fade-leave-active[data-v-d9fcd727]{transition:opacity .1s ease}.fade-enter-from[data-v-d9fcd727],.fade-leave-to[data-v-d9fcd727]{opacity:0}.info-icon[data-v-ff60cff4]{font-size:var(--el-font-size-base);cursor:pointer}.status-icon[data-v-f46b6729]{font-size:var(--el-font-size-base)}.blth_btn{background-color:#23ade5;font-size:small;margin-inline-start:5px;color:#fff;border-radius:4px;border:none;padding:5px;cursor:pointer;box-shadow:0 0 2px #00000075;line-height:10px;margin-left:15px}.blth_btn:hover{background-color:#1097cc}.blth_btn:hover:active{background-color:#0e86b6;position:relative;top:1px} "),async function(e,t,i,o,s,a,n,r){"use strict";function l(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e)for(const i in e)if("default"!==i){const o=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>e[i]})}return t.default=e,Object.freeze(t)}const c=l(o);var d,u=Object.defineProperty,h=(e,t,i)=>(((e,t,i)=>{t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i),m=(()=>"undefined"!=typeof GM_addStyle?GM_addStyle:void 0)(),g=(()=>"undefined"!=typeof GM_getValue?GM_getValue:void 0)(),f=(()=>"undefined"!=typeof GM_setValue?GM_setValue:void 0)(),p=(()=>"undefined"!=typeof GM_xmlhttpRequest?GM_xmlhttpRequest:void 0)(),v=(()=>"undefined"!=typeof unsafeWindow?unsafeWindow:void 0)();const y={ui:{isCollapse:!1,isShowPanel:!0,activeMenuIndex:"MainSiteTasks"},modules:{DailyTasks:{MainSiteTasks:{login:{enabled:!1,_lastCompleteTime:0},watch:{enabled:!1,_lastCompleteTime:0},coin:{enabled:!1,num:1,_lastCompleteTime:0},share:{enabled:!1,_lastCompleteTime:0}},LiveTasks:{sign:{enabled:!1,_lastCompleteTime:0},medalTasks:{danmu:{enabled:!1,list:["(⌒▽⌒)","（￣▽￣）","(=・ω・=)","(｀・ω・´)","(〜￣△￣)〜","(･∀･)","(°∀°)ﾉ","╮(￣▽￣)╭","_(:3」∠)_","(^・ω・^ )","(●￣(ｴ)￣●)","ε=ε=(ノ≧∇≦)ノ","⁄(⁄ ⁄•⁄ω⁄•⁄ ⁄)⁄","←◡←","(●'◡'●)ﾉ♥"],_lastCompleteTime:0},like:{enabled:!1,includeHighLevelMedals:!1,_lastCompleteTime:0},watch:{enabled:!1,time:70,_watchedSecondsToday:0,_lastWatchTime:0,_lastCompleteTime:0},isWhiteList:!1,roomidList:[]}},OtherTasks:{groupSign:{enabled:!1,_lastCompleteTime:0},silverToCoin:{enabled:!1,_lastCompleteTime:0},coinToSilver:{enabled:!1,num:1,_lastCompleteTime:0},getYearVipPrivilege:{enabled:!1,_nextReceiveTime:0}}},EnhanceExperience:{switchLiveStreamQuality:{enabled:!1,qualityDesc:"原画"},banp2p:{enabled:!1},noReport:{enabled:!1},noSleep:{enabled:!1},invisibility:{enabled:!1}},RemoveElement:{removePKBox:{enabled:!1},removeLiveWaterMark:{enabled:!1},removeShopPopover:{enabled:!1},removeGiftPopover:{enabled:!1},removeGameParty:{enabled:!1}}},cache:{lastAliveHeartBeatTime:0}};class w{static mergeConfigs(e,t){const o=i.difference(i.keys(e),i.keys(t));e=i.omit(e,o);const s=i.difference(i.keys(t),i.keys(e));i.assign(e,i.pick(t,s));for(const[o,a]of Object.entries(e).filter((e=>!s.includes(e[0]))))i.isPlainObject(a)&&(e[o]=this.mergeConfigs(a,t[o]));return e}static setUiConfig(e){f("ui",e)}static getUiConfig(){return this.mergeConfigs(g("ui",{}),y.ui)}static setModuleConfig(e){f("modules",e)}static getModuleConfig(){return this.mergeConfigs(g("modules",{}),y.modules)}static setCache(e){f("cache",e)}static getCache(){return this.mergeConfigs(g("cache",{}),y.cache)}}const _=t.defineStore("ui",(()=>{const t=e.reactive(w.getUiConfig()),o=e.computed((()=>({MainSiteTasks:"主站任务",LiveTasks:"直播任务",OtherTasks:"其它任务",EnhanceExperience:"体验优化",RemoveElement:"移除元素"}[t.activeMenuIndex]))),s=e.reactive({top:0,left:0,height:0,width:0}),a=e.computed((()=>({top:s.top.toString()+"px",left:s.left.toString()+"px",height:s.height.toString()+"px",width:s.width.toString()+"px"}))),n=e.computed((()=>t.isShowPanel?"隐藏控制面板":"显示控制面板")),r=e.computed((()=>(s.height-60).toString()+"px"));return e.watch(t,i.debounce((e=>w.setUiConfig(e)),350)),{isShowPanelButtonText:n,activeMenuName:o,baseStyleValue:s,baseStyle:a,scrollBarHeight:r,uiConfig:t,changeCollapse:function(){t.isCollapse=!t.isCollapse},changeShowPanel:function(){t.isShowPanel=!t.isShowPanel},setActiveMenuIndex:function(e){t.activeMenuIndex=e}}})),x={class:"title"},T=(e,t)=>{const i=e.__vccOpts||e;for(const[e,o]of t)i[e]=o;return i},b=T(e.defineComponent({__name:"PanelHeader",setup(t){const i=_();return(t,s)=>{const a=e.resolveComponent("el-icon"),n=e.resolveComponent("el-text");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{class:"collapse-btn",onClick:s[0]||(s[0]=(...t)=>e.unref(i).changeCollapse&&e.unref(i).changeCollapse(...t))},[e.unref(i).uiConfig.isCollapse?(e.openBlock(),e.createBlock(a,{key:0},{default:e.withCtx((()=>[e.createVNode(e.unref(o.Expand))])),_:1})):(e.openBlock(),e.createBlock(a,{key:1},{default:e.withCtx((()=>[e.createVNode(e.unref(o.Fold))])),_:1}))]),e.createElementVNode("div",x,[e.createVNode(n,{tag:"b",class:"header-big-text"},{default:e.withCtx((()=>[e.createTextVNode("控制面板")])),_:1}),e.createVNode(n,{class:"header-small-text"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(e.unref(i).activeMenuName),1)])),_:1})])],64)}}}),[["__scopeId","data-v-e675db5f"]]),k=e.defineComponent({__name:"PanelAside",setup(t){const i=_(),o=[{icon:"Tasks",title:"每日任务",index:"DailyTasks",subs:[{title:"主站任务",index:"MainSiteTasks"},{title:"直播任务",index:"LiveTasks"},{title:"其它任务",index:"OtherTasks"}]},{icon:"Monitor",title:"体验优化",index:"EnhanceExperience"},{icon:"Scissor",title:"移除元素",index:"RemoveElement"}];return(t,s)=>{const a=e.resolveComponent("el-icon"),n=e.resolveComponent("el-menu-item"),r=e.resolveComponent("el-sub-menu"),l=e.resolveComponent("el-menu");return e.openBlock(),e.createBlock(l,{"default-active":e.unref(i).uiConfig.activeMenuIndex,style:e.normalizeStyle({"min-height":e.unref(i).scrollBarHeight}),collapse:e.unref(i).uiConfig.isCollapse,"unique-opened":"",onSelect:e.unref(i).setActiveMenuIndex,id:"aside-el-menu"},{default:e.withCtx((()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(o,(t=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[t.subs?(e.openBlock(),e.createBlock(r,{index:t.index,key:t.index},{title:e.withCtx((()=>[e.createVNode(a,null,{default:e.withCtx((()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.icon)))])),_:2},1024),e.createElementVNode("span",null,e.toDisplayString(t.title),1)])),default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.subs,(t=>(e.openBlock(),e.createBlock(n,{key:t.index,index:t.index},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(t.title),1)])),_:2},1032,["index"])))),128))])),_:2},1032,["index"])):(e.openBlock(),e.createBlock(n,{index:t.index,key:t.index},{title:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(t.title),1)])),default:e.withCtx((()=>[e.createVNode(a,null,{default:e.withCtx((()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.icon)))])),_:2},1024)])),_:2},1032,["index"]))],64)))),64))])),_:1},8,["default-active","style","collapse","onSelect"])}}}),C=t.defineStore("bili",(()=>{const t=e.ref(null),i=e.ref(null),o=e.ref(null),s=e.ref(null),a=e.ref(null),n=e.ref(null),r=e.ref(null),l=e.computed((()=>{var e;return(null==(e=r.value)?void 0:e.filter((e=>0!==e.room_info.room_id)))??null}));return{BilibiliLive:t,userInfo:o,giftConfig:s,cookies:i,dailyRewardInfo:a,dynamicVideos:n,fansMedals:r,filteredFansMedals:l}}));let V=class{constructor(e,t){h(this,"url_prefix"),h(this,"origin"),this.url_prefix=e??"",this.origin=t??"https://bilibili.com"}get(e,t,o){return new Promise(((s,a)=>{const n={method:"GET",url:this.url_prefix+e+(t?"?"+new URLSearchParams(t).toString():""),responseType:"json",headers:{Accept:"application/json, text/plain, */*",Referer:this.origin,Origin:this.origin,"Sec-Fetch-Site":"same-site"},onload:function(e){s(e.response)},onerror:function(e){a(e)}},r=i.defaultsDeep(o,n);p(r)}))}post(e,t,o){return new Promise(((s,a)=>{const n={method:"POST",url:this.url_prefix.concat(e),data:new URLSearchParams(t).toString(),responseType:"json",headers:{Accept:"application/json, text/plain, */*",Referer:this.origin,Origin:this.origin,"Sec-Fetch-Site":"same-site","Content-Type":"application/x-www-form-urlencoded"},onload:function(e){s(e.response)},onerror:function(e){a(e)}},r=i.defaultsDeep(o,n);"multipart/form-data"===r.headers["Content-Type"]&&delete r.headers["Content-Type"],p(r)}))}};function S(e){return new Promise((t=>setTimeout(t,e)))}function N(e){const t=new FormData;return i.forEach(e,((e,i)=>t.append(i,e.toString()))),t}function P(e,t,o){i.forOwn(e,(function(e,s){const a=o?o+"."+s:s;i.isPlainObject(e)&&!i.isEmpty(e)?P(e,t,a):t(e,a)}))}function D(e){switch(e){case"document-start":return Promise.resolve();case"document-head":return new Promise((e=>{if(document.head)e();else{const t=new MutationObserver((()=>{document.head&&(t.disconnect(),e())}));t.observe(document.documentElement,{childList:!0})}}));case"document-body":return new Promise((e=>{if(document.body)e();else{const t=new MutationObserver((()=>{document.body&&(t.disconnect(),e())}));t.observe(document.documentElement,{childList:!0})}}));case"document-end":return new Promise((e=>{"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",(()=>e()))}));case"window-load":return new Promise((e=>{"complete"===document.readyState?e():window.addEventListener("load",(()=>e()))}));default:return Promise.reject("Illegal moment")}}function B(e,t=0,i=5){const o=s.DateTime.fromMillis(e),a=s.DateTime.now().set({hour:t,minute:i,second:0,millisecond:0}),n=a.plus({days:1}),r=a.minus({days:1});return s.DateTime.now()>=a?o>=a&&o<n:o>=r&&o<a}function M(e=0,t=5){const i=s.DateTime.now();let o=s.DateTime.local(i.year,i.month,i.day,e,t);i>o&&(o=o.plus({days:1}));const a=o.diff(i);return{ms:a.toMillis(),str:a.toFormat("h小时m分钟s秒").replace(/^0小时/,"").replace(/^0分钟/,"")}}function E(e,t,i,o){const a=s.DateTime.now(),n=s.DateTime.local(a.year,a.month,a.day,e,t),r=s.DateTime.local(a.year,a.month,a.day,i,o);return a>=n&&a<r}function I(){return Math.round(s.DateTime.now().toSeconds())}function L(){return s.DateTime.now().toMillis()}s.Settings.defaultZone="Asia/Shanghai";const R={live:new V("https://api.live.bilibili.com","https://live.bilibili.com"),liveTrace:new V("https://live-trace.bilibili.com","https://live.bilibili.com"),passport:new V("https://passport.bilibili.com","https://passport.bilibili.com/"),main:new V("https://api.bilibili.com","https://www.bilibili.com"),vc:new V("https://api.vc.bilibili.com","https://message.bilibili.com/"),raw:new V},O={roomGiftConfig:(e=0,t=0,i=0,o="pc")=>R.live.get("/xlive/web-room/v1/giftPanel/roomGiftConfig",{platform:o,room_id:e,area_parent_id:t,area_id:i}),doSign:()=>R.live.get("/xlive/web-ucenter/v1/sign/DoSign"),getSignInfo:()=>R.live.get("/xlive/web-ucenter/v1/sign/WebGetSignInfo"),fansMedalPanel:(e,t=10)=>R.live.get("/xlive/app-ucenter/v1/fansMedal/panel",{page:e,page_size:t},{Origin:"https://link.bilibili.com",Referer:"https://link.bilibili.com/p/center/index"}),sendMsg:(e,t,i=0,o=1,s=0,a=25,n=16777215,r=0)=>{const l=C().cookies.bili_jct;return R.live.post("/msg/send",void 0,{data:N({roomid:t,room_type:i,rnd:I(),msg:e,mode:o,jumpfrom:s,fontsize:a,csrf:l,csrf_token:l,color:n,bubble:r}),headers:{"Content-Type":"multipart/form-data"}})},likeReport:(e,t,i=1)=>{const o=C().cookies.bili_jct;return R.live.post("/xlive/app-ucenter/v1/like_info_v3/like/likeReportV3",{click_time:i,room_id:e,anchor_id:t,uid:t,ts:I(),csrf:o})},getInfoByRoom:e=>R.live.get("/xlive/web-room/v1/index/getInfoByRoom",{room_id:e}),getUserTaskProgress:(e=11153765)=>{const t=C().cookies.bili_jct;return R.live.get("/xlive/app-ucenter/v1/userTask/GetUserTaskProgress",{target_id:e,csrf:t,ts:I()})},userTaskReceiveRewards:(e=11153765)=>{const t=C().cookies.bili_jct;return R.live.post("/xlive/app-ucenter/v1/userTask/UserTaskReceiveRewards",{actionKey:"csrf",target_id:e,csrf:t,ts:I()})},silver2coin:(e="")=>{const t=C().cookies.bili_jct;return R.live.post("/xlive/revenue/v1/wallet/silver2coin",{csrf:t,csrf_token:t,visit_id:e})},coin2silver:(e,t="pc",i="")=>{const o=C().cookies.bili_jct;return R.live.post("/xlive/revenue/v1/wallet/coin2silver",{num:e,csrf:o,csrf_token:o,platform:t,visit_id:i})}},A={E:(e,t,i,o=0,s=[],a="")=>{const n=C().cookies.bili_jct;return R.liveTrace.post("/xlive/data-interface/v1/x25Kn/E",{id:JSON.stringify(e),device:JSON.stringify(t),ruid:i,ts:L(),is_patch:o,heart_beat:JSON.stringify(s),ua:navigator.userAgent,csrf_token:n,csrf:n,visit_id:a})},X:(e,t,i,o,s,a,n,r,l="")=>{const c=C().cookies.bili_jct;return R.liveTrace.post("/xlive/data-interface/v1/x25Kn/X",{s:e,id:JSON.stringify(t),device:JSON.stringify(i),ruid:o,ets:s,benchmark:a,time:n,ts:r,ua:navigator.userAgent,csrf_token:c,csrf:c,visit_id:l})}},$={nav:()=>R.main.get("/x/web-interface/nav"),reward:()=>R.main.get("/x/member/web/exp/reward"),dynamicAll:(e,t=1,i=-480,o="itemOpusStyle")=>R.main.get("/x/polymer/web-dynamic/v1/feed/all",{timezone_offset:i,type:e,page:t,features:o}),videoHeartbeat:(e,t="",i=0,o=0,s=0,a="https://t.bilibili.com/?spm_id_from=444.3.0.0",n=116,r=100,l=3,c=0,d=0,u=2,h=0,m=0,g="333.488.0.0",f="333.31.list.card_archive.click",p='{"player_version":"4.1.21-rc.1727.0"}')=>{var v;const y=C();return R.main.post("/x/click-interface/web/heartbeat",{start_ts:I(),mid:null==(v=C().userInfo)?void 0:v.mid,aid:e,cid:t,type:l,sub_type:c,dt:u,play_type:d,realtime:i,played_time:o,real_played_time:s,refer_url:a,quality:n,video_duration:r,last_play_progress_time:h,max_play_progress_time:m,spmid:g,from_spmid:f,extra:p,csrf:y.cookies.bili_jct})},share:(e,t="pc_client_normal",i=2,o=0,s=1)=>{const a=C().cookies.bili_jct;return R.main.post("/x/web-interface/share/add",{aid:e,eab_x:i,ramval:o,source:t,ga:s,csrf:a})},coinAdd:(e,t,i=0,o=!0,s=2,a=6,n="web_normal",r=1)=>{const l=C().cookies.bili_jct;return R.main.post("/x/web-interface/coin/add ",{aid:e,multiply:t,select_like:i,cross_domain:o,eab_x:s,ramval:a,source:n,ga:r,csrf:l})},videoRelation:(e,t="")=>R.main.get("/x/web-interface/archive/relation",{aid:e,bvid:t}),vip:{myPrivilege:()=>{const e=C().cookies.bili_jct;return R.main.get("/x/vip/privilege/my",{csrf:e},{headers:{Referer:"https://account.bilibili.com/account/big/myPackage",Origin:"https://account.bilibili.com/account/big/myPackage"}})},receivePrivilege:(e,t="web")=>{const i=C().cookies.bili_jct;return R.main.post("/x/vip/privilege/receive",{type:e,platform:t,csrf:i},{headers:{Referer:"https://account.bilibili.com/account/big/myPackage",Origin:"https://account.bilibili.com/account/big/myPackage"}})}}},j={myGroups:(e=0,t="web")=>R.vc.get("/link_group/v1/member/my_groups",{build:e,mobi_app:t}),signIn:(e,t)=>R.vc.get("/link_setting/v1/link_setting/sign_in",{group_id:e,owner_id:t})};class H{constructor(e){h(this,"NAME","BLTH"),h(this,"prefix_title_str"),h(this,"title"),this.title=e,this.prefix_title_str=e.split("_").join("][")}get prefix(){return[`%c${this.NAME}%c[${(new Date).toLocaleString()}]%c[${this.prefix_title_str}]%c:`,"font-weight: bold; color: white; background-color: #23ade5; padding: 1px 4px; border-radius: 4px;","font-weight: bold; color: #0920e6;","font-weight: bold;",""]}log(...e){console.log(...this.prefix,...e)}error(...e){console.error(...this.prefix,...e)}warn(...e){console.warn(...this.prefix,...e)}}class U{constructor(e){h(this,"moduleName"),h(this,"logger"),h(this,"moduleStore",Oe()),h(this,"config"),this.moduleName=e,this.logger=new H(this.moduleName)}set status(e){throw new Error("Method not implemented.")}run(){throw new Error("Method not implemented.")}}h(U,"runOnMultiplePages",!1),h(U,"runAt","document-body"),h(U,"onFrame","target"),h(U,"runAfterDefault",!0);function z(e,t=200,i=1e4){return new Promise(((o,s)=>{const a=Date.now(),n=new Set(e),r={},l=setInterval((()=>{Object.assign(r,function(e){const t={},i=new Set(e);for(const e of i)t[e]=null;for(const e of document.cookie.split("; ")){const[o,...s]=e.split("="),a=s.join("=");if(i.has(o)&&(t[o]=decodeURIComponent(a),i.delete(o),0===i.size))break}return t}(n));for(const e in r)null!==r[e]&&n.delete(e);0===n.size?(clearInterval(l),o(r)):-1!==i&&Date.now()-a>i&&(clearInterval(l),s("获取以下Cookies超时: "+[...n]))}),t)}))}const F=Object.freeze(Object.defineProperty({__proto__:null,Default_BilibiliLive:class extends U{getBilibiliLive(){return this.logger.log("unsafeWindow.BilibiliLive",v.BilibiliLive),new Promise((e=>{0===v.BilibiliLive.UID?v.BilibiliLive=new Proxy(v.BilibiliLive,{set:(t,i,o)=>(t[i]=o,"UID"===i&&(v.BilibiliLive=t,e(v.BilibiliLive)),!0)}):e(v.BilibiliLive)}))}async run(){C().BilibiliLive=await this.getBilibiliLive()}},Default_Cookies:class extends U{getCookies(){return z(["bili_jct","LIVE_BUVID"])}async run(){C().cookies=await this.getCookies()}},Default_DailyRewardInfo:class extends U{async getDailyRewardInfo(){const e=this.moduleStore.moduleConfig.DailyTasks.MainSiteTasks;if(!Object.values(e).some((e=>e.enabled&&!B(e._lastCompleteTime))))return Promise.resolve(null);try{const e=await $.reward();return this.logger.log("BAPI.main.reward response",e),0===e.code?Promise.resolve(e.data):(this.logger.error("获取主站每日任务完成情况失败",e.message),Promise.reject(e.message))}catch(e){return this.logger.error("获取主站每日任务完成情况出错",e),Promise.reject(e)}}async run(){const e=C();e.dailyRewardInfo=await this.getDailyRewardInfo(),setTimeout((async()=>{e.dailyRewardInfo=await this.getDailyRewardInfo()}),M(0,4).ms)}},Default_DynamicVideos:class extends U{async getDynamicVideos(){const e=this.moduleStore.moduleConfig.DailyTasks.MainSiteTasks;if(!Object.entries(e).filter((([e])=>["watch","share","coin"].includes(e))).some((e=>e[1].enabled&&!B(e[1]._lastCompleteTime))))return Promise.resolve(null);try{const e=await $.dynamicAll("video");return this.logger.log("BAPI.main.dynamicAll response",e),0===e.code?Promise.resolve(e.data.items):(this.logger.error("获取主站每日任务完成情况失败",e.message),Promise.reject(e.message))}catch(e){return this.logger.error("获取主站每日任务完成情况出错",e),Promise.reject(e)}}async run(){const e=C();e.dynamicVideos=await this.getDynamicVideos(),setTimeout((async()=>{e.dynamicVideos=await this.getDynamicVideos()}),M(0,4).ms)}},Default_FansMetals:class extends U{async getFansMetals(e=1/0,t=!1){const i=this.moduleStore.moduleConfig.DailyTasks.LiveTasks.medalTasks;if(!t&&!Object.entries(i).filter((([e])=>["danmu","like","watch"].includes(e))).some((e=>e[1].enabled&&!B(e[1]._lastCompleteTime))))return Promise.resolve(null);{const t=[];let i=1;try{const o=await O.fansMedalPanel(1);if(this.logger.log("BAPI.live.fansMedalPanel(1) response",o),0!==o.code)return this.logger.error("获取粉丝勋章列表第1页失败",o.message),Promise.reject(o.message);i=o.data.page_info.total_page,t.push(...o.data.special_list,...o.data.list);for(let s=2;s<=Math.min(i,e);s++){const e=await O.fansMedalPanel(s);if(this.logger.log(`BAPI.live.fansMedalPanel(${s}) response`,e),0!==o.code)return this.logger.error(`获取粉丝勋章列表第${s}页失败`,o.message),t;t.push(...e.data.list),await S(250)}return Promise.resolve(t)}catch(e){return this.logger.error("获取粉丝勋章列表出错",e),Promise.reject(e)}}}async run(){const e=C();e.fansMedals=await this.getFansMetals(),setTimeout((async()=>{const t=await this.getFansMetals(1,!0);null==t||t.forEach((t=>{var i;(null==(i=e.fansMedals)?void 0:i.every((e=>e.medal.target_id!==t.medal.target_id)))&&e.fansMedals.push(t)}))}),M(0,4).ms),Oe().emitter.on("Default_FansMedals",(async()=>{e.fansMedals=await this.getFansMetals(1/0,!0)}))}},Default_UserInfo:class extends U{async getUserInfo(){try{const e=await $.nav();return this.logger.log("BAPI.main.nav response",e),0===e.code?Promise.resolve(e.data):(this.logger.error("获取用户信息失败",e.message),Promise.reject(e.message))}catch(e){return this.logger.error("获取用户信息出错",e),Promise.reject(e)}}async run(){const e=C();e.userInfo=await this.getUserInfo(),setTimeout((async()=>{e.userInfo=await this.getUserInfo()}),M(0,4).ms)}}},Symbol.toStringTag,{value:"Module"}));const G=document.querySelector.bind(document);document.querySelectorAll.bind(document);const q=document.createElement.bind(document),K=()=>v.self===v.top;class W{constructor(e,t,i,o,s,a=!1){h(this,"logger",new H("RoomHeart")),h(this,"config"),h(this,"isLast"),h(this,"watchedSeconds"),h(this,"timer"),h(this,"stop",!1),h(this,"areaID"),h(this,"parentID"),h(this,"roomID"),h(this,"ruid"),h(this,"seq",0),h(this,"buvid",(null==(d=C().cookies)?void 0:d.LIVE_BUVID)??function(e){const t=`; ${document.cookie}`.split(`; ${e}=`);return 2===t.length?t.pop().split(";").shift():null}("LIVE_BUVID")),h(this,"uuid","xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))),h(this,"device",[this.buvid,this.uuid]),h(this,"ua",navigator.userAgent),h(this,"heartBeatInterval"),h(this,"secretKey"),h(this,"secretRule"),h(this,"timestamp"),this.roomID=e,this.areaID=t,this.parentID=i,this.ruid=o,this.watchedSeconds=s,this.isLast=a,this.config=Oe().moduleConfig.DailyTasks.LiveTasks.medalTasks.watch}set status(e){Oe().moduleStatus.DailyTasks.LiveTasks.medalTasks.watch=e}get id(){return[this.parentID,this.areaID,this.seq,this.roomID]}start(){if(this.buvid)return this.timer=setTimeout((()=>this.stop=!0),M(0,0).ms),this.E();this.logger.error(`缺少buvid，无法为直播间 ${this.roomID} 执行观看直播任务，请尝试刷新页面`)}async E(){if(this.stop)this.status="";else try{const e=await A.E(this.id,this.device,this.ruid);this.logger.log(`BAPI.liveTrace.E(${this.id}, ${this.device}, ${this.ruid}) response`,e),0===e.code?(this.seq+=1,({heartbeat_interval:this.heartBeatInterval,secret_key:this.secretKey,secret_rule:this.secretRule,timestamp:this.timestamp}=e.data),setTimeout((()=>this.X()),1e3*this.heartBeatInterval)):this.logger.error(`BAPI.liveTrace.E(${this.id}, ${this.device}, ${this.ruid}) 失败`,e.message)}catch(e){this.logger.error(`BAPI.liveTrace.E(${this.id}, ${this.device}, ${this.ruid}) 出错`,e)}}async X(){if(this.stop)this.status="";else try{const e={id:JSON.stringify(this.id),device:JSON.stringify(this.device),ets:this.timestamp,benchmark:this.secretKey,time:this.heartBeatInterval,ts:L(),ua:this.ua},t=this.sypder(JSON.stringify(e),this.secretRule),i=await A.X(t,this.id,this.device,this.ruid,this.timestamp,this.secretKey,this.heartBeatInterval,e.ts);if(this.logger.log(`BAPI.liveTrace.X(${t}, ${this.id}, ${this.device}, ${this.ruid}, ${this.timestamp}, ${this.secretKey}, ${this.heartBeatInterval}, ${e.ts}) response`,i),0===i.code){if(this.seq+=1,this.watchedSeconds+=this.heartBeatInterval,this.isLast&&(this.config._watchedSecondsToday=this.watchedSeconds),this.watchedSeconds>=60*this.config.time)return this.isLast&&(this.config._lastCompleteTime=L(),this.logger.log("观看直播任务已完成"),this.status="done"),void clearTimeout(this.timer);({heartbeat_interval:this.heartBeatInterval,secret_key:this.secretKey,secret_rule:this.secretRule,timestamp:this.timestamp}=i.data),setTimeout((()=>this.X()),1e3*this.heartBeatInterval)}else this.logger.error(`BAPI.liveTrace.X(${t}, ${this.id}, ${this.device}, ${this.ruid}, ${this.timestamp}, ${this.secretKey}, ${this.heartBeatInterval}) 失败`,i.message)}catch(e){this.logger.error(`BAPI.liveTrace.X(s, ${this.id}, ${this.device}, ${this.ruid}, ${this.timestamp}, ${this.secretKey}, ${this.heartBeatInterval}) 出错`,e)}}sypder(e,t){const i=JSON.parse(e),[o,s,n,r]=JSON.parse(i.id),[l,c]=JSON.parse(i.device),d=i.benchmark,u={platform:"web",parent_id:o,area_id:s,seq_id:n,room_id:r,buvid:l,uuid:c,ets:i.ets,time:i.time,ts:i.ts};let h=JSON.stringify(u);for(const e of t)switch(e){case 0:default:h=a.HmacMD5(h,d).toString(a.enc.Hex);break;case 1:h=a.HmacSHA1(h,d).toString(a.enc.Hex);break;case 2:h=a.HmacSHA256(h,d).toString(a.enc.Hex);break;case 3:h=a.HmacSHA224(h,d).toString(a.enc.Hex);break;case 4:h=a.HmacSHA512(h,d).toString(a.enc.Hex);break;case 5:h=a.HmacSHA384(h,d).toString(a.enc.Hex)}return h}}class X extends U{constructor(){super(...arguments),h(this,"medalTasksConfig",this.moduleStore.moduleConfig.DailyTasks.LiveTasks.medalTasks),h(this,"config",this.medalTasksConfig.watch)}set status(e){this.moduleStore.moduleStatus.DailyTasks.LiveTasks.medalTasks.watch=e}getRoomidUidList(){const e=C();return e.filteredFansMedals?e.filteredFansMedals.filter((e=>e.medal.level<20&&(this.medalTasksConfig.isWhiteList?this.medalTasksConfig.roomidList.includes(e.room_info.room_id):!this.medalTasksConfig.roomidList.includes(e.room_info.room_id)))).map((e=>[e.room_info.room_id,e.medal.target_id])).slice(0,199):null}async getAreaInfo(e){try{const t=await O.getInfoByRoom(e);if(this.logger.log(`BAPI.live.getInfoByRoom(${e}) response`,t),0===t.code){const e=t.data.room_info;return[e.area_id,e.parent_area_id]}return[-1,-1]}catch(t){return this.logger.error(`获取指定直播间的 area_id 和 parent_area_id(roomid = ${e}) 出错`,t),[-1,-1]}}async run(){if(this.logger.log("观看直播模块开始运行"),this.config.enabled)if(B(this.config._lastCompleteTime))E(0,0,0,5)?this.logger.log("昨天的观看直播任务已经完成过了，等到今天的00:05再执行"):(this.logger.log("今天已经完成过观看直播任务了"),this.status="done");else{this.status="running",B(this.config._lastWatchTime,0,0)?this.config._watchedSecondsToday-=this.config._watchedSecondsToday%300:this.config._watchedSecondsToday=0,this.config._lastWatchTime=L();const e=this.getRoomidUidList();if(e)if(0===e.length)this.status="done",this.config._lastCompleteTime=L();else for(let t=0;t<e.length;t++){const[i,o]=e[t],[s,a]=await this.getAreaInfo(i);s>0&&a>0&&new W(i,s,a,o,this.config._watchedSecondsToday,t===e.length-1).start(),await S(3e3)}}const e=M();setTimeout((()=>this.run()),e.ms),this.logger.log("距离观看直播模块下次运行时间:",e.str)}}h(X,"runAt","window-load");class J extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.EnhanceExperience.switchLiveStreamQuality)}async waitForPlayer(){return new Promise(((e,t)=>{const i=v.top?v.top:v,o=setInterval((()=>{i.livePlayer&&Object.prototype.hasOwnProperty.call(i.livePlayer,"switchQuality")&&Object.prototype.hasOwnProperty.call(i.livePlayer,"getPlayerInfo")&&(clearInterval(o),clearTimeout(s),e(i.livePlayer))}),200),s=setTimeout((()=>{clearInterval(o),clearTimeout(s),t("等待播放器超时")}),1e4)}))}async switchQuality(e){const t=e.getPlayerInfo();0===t.liveStatus?this.logger.log("当前直播间未开播，无需切换画质"):setTimeout((()=>{const i=t.qualityCandidates.find((({desc:e})=>e===this.config.qualityDesc));i?t.quality!==i.qn?(e.switchQuality(i.qn),this.logger.log(`已将画质切换为${this.config.qualityDesc}`,i)):this.logger.log("当前画质已经是目标画质了，无需切换画质"):this.logger.log("当前直播不支持目标画质，保持默认画质")}),K()?2500:5e3)}async run(){if(this.logger.log("自动切换画质模块开始运行"),this.config.enabled)try{const e=await this.waitForPlayer();this.switchQuality(e)}catch(e){this.logger.error("自动切换画质模块出错",e)}}}h(J,"runOnMultiplePages",!0),h(J,"runAt","window-load"),h(J,"runAfterDefault",!1);class Q extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.EnhanceExperience.banp2p)}banP2P(){const e=["RTCPeerConnection","mozRTCPeerConnection","webkitRTCPeerConnection"];for(const t of e)Object.prototype.hasOwnProperty.call(v,t)&&Object.defineProperty(v,t,{value:class{constructor(){}addEventListener(){}removeEventListener(){}createDataChannel(){return{close:function(){}}}createOffer(){return Promise.resolve()}setLocalDescription(){return Promise.resolve()}close(){}setRemoteDescription(){return Promise.resolve()}createAnswer(){}},enumerable:!1,writable:!1,configurable:!1})}run(){if(this.logger.log("禁用P2P模块开始运行"),this.config.enabled)try{this.banP2P()}catch(e){this.logger.error("禁用P2P失败",e)}}}h(Q,"runOnMultiplePages",!0),h(Q,"runAt","document-start"),h(Q,"onFrame","all"),h(Q,"runAfterDefault",!1);var Y=["load","loadend","timeout","error","readystatechange","abort"],Z="__origin_xhr";function ee(e,t){var i={};for(var o in e)i[o]=e[o];return i.target=i.currentTarget=t,i}var te=Y[0],ie=Y[1],oe=Y[2],se=Y[3],ae=Y[4],ne=Y[5],re="prototype";function le(e,t){return function(e,t){var i=e.onRequest,o=e.onResponse,s=e.onError;function a(e){var t=e.responseType;if(!t||"text"===t)return e.responseText;var i=e.response;if("json"===t&&!i)try{return JSON.parse(e.responseText)}catch(e){console.warn(e)}return i}function n(e,t){var i=new ge(e),s={response:a(t),status:t.status,statusText:t.statusText,config:e.config,headers:e.resHeader||e.getAllResponseHeaders().split("\r\n").reduce((function(e,t){if(""===t)return e;var i=t.split(":");return e[i.shift()]=function(e){return e.replace(/^\s+|\s+$/g,"")}(i.join(":")),e}),{})};if(!o)return i.resolve(s);o(s,i)}function r(e,t,i,o){var a=new fe(e);i={config:e.config,error:i,type:o},s?s(i,a):a.next(i)}function l(){return!0}function c(e){return function(t,i){return r(t,this,i,e),!0}}function d(e,t){return 4===e.readyState&&0!==e.status?n(e,t):4!==e.readyState&&de(e,ae),!0}var{originXhr:u,unHook:h}=function(e,t){var i=(t=t||window).XMLHttpRequest,o=!0,s=function(){for(var e=new i,t=0;t<Y.length;++t){var o="on"+Y[t];void 0===e[o]&&(e[o]=null)}for(var s in e){var l="";try{l=typeof e[s]}catch(e){}"function"===l?this[s]=r(s):s!==Z&&Object.defineProperty(this,s,{get:a(s),set:n(s),enumerable:!0})}var c=this;e.getProxy=function(){return c},this[Z]=e};function a(t){return function(){var i=this[Z][t];if(o){var s=this.hasOwnProperty(t+"_")?this[t+"_"]:i,a=(e[t]||{}).getter;return a&&a(s,this)||s}return i}}function n(t){return function(i){var s=this[Z];if(o){var a=this,n=e[t];if("on"===t.substring(0,2))a[t+"_"]=i,s[t]=function(o){o=ee(o,a),e[t]&&e[t].call(a,s,o)||i.call(a,o)};else{var r=(n||{}).setter;i=r&&r(i,a)||i,this[t+"_"]=i;try{s[t]=i}catch(e){}}}else s[t]=i}}function r(t){return function(){var i=[].slice.call(arguments);if(e[t]&&o){var s=e[t].call(this,i,this[Z]);if(s)return s}return this[Z][t].apply(this[Z],i)}}return(s.prototype=i.prototype).constructor=s,t.XMLHttpRequest=s,Object.assign(t.XMLHttpRequest,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4}),{originXhr:i,unHook:function(){o=!1,t.XMLHttpRequest===s&&(t.XMLHttpRequest=i,s.prototype.constructor=i,i=void 0)}}}({onload:l,onloadend:l,onerror:c(se),ontimeout:c(oe),onabort:c(ne),onreadystatechange:function(e){return d(e,this)},open:function(e,t){var o=this,s=t.config={headers:{}};s.method=e[0],s.url=e[1],s.async=e[2],s.user=e[3],s.password=e[4],s.xhr=t;var a="on"+ae;if(t[a]||(t[a]=function(){return d(t,o)}),i)return!0},send:function(e,t){var o=t.config;if(o.withCredentials=t.withCredentials,o.body=e[0],i){var s=function(){i(o,new me(t))};return!1===o.async?s():setTimeout(s),!0}},setRequestHeader:function(e,t){if(t.config.headers[e[0].toLowerCase()]=e[1],i)return!0},addEventListener:function(e,t){var i=this;if(-1!==Y.indexOf(e[0])){var o=e[1];return ce(t).addEventListener(e[0],(function(t){var s=ee(t,i);s.type=e[0],s.isTrusted=!0,o.call(i,s)})),!0}},getAllResponseHeaders:function(e,t){var i=t.resHeader;if(i){var o="";for(var s in i)o+=s+": "+i[s]+"\r\n";return o}},getResponseHeader:function(e,t){var i=t.resHeader;if(i)return i[(e[0]||"").toLowerCase()]}},t);return{originXhr:u,unProxy:h}}(e,t=t||window)}function ce(e){return e.watcher||(e.watcher=document.createElement("a"))}function de(e,t){var i,o=e.getProxy(),s="on"+t+"_",a=ee({type:t},o);o[s]&&o[s](a),"function"==typeof Event?i=new Event(t,{bubbles:!1}):(i=document.createEvent("Event")).initEvent(t,!1,!0),ce(e).dispatchEvent(i)}function ue(e){this.xhr=e,this.xhrProxy=e.getProxy()}function he(e){function t(e){ue.call(this,e)}return t[re]=Object.create(ue[re]),t[re].next=e,t}ue[re]=Object.create({resolve:function(e){var t=this.xhrProxy,i=this.xhr;t.readyState=4,i.resHeader=e.headers,t.response=t.responseText=e.response,t.statusText=e.statusText,t.status=e.status,de(i,ae),de(i,te),de(i,ie)},reject:function(e){this.xhrProxy.status=0,de(this.xhr,e.type),de(this.xhr,ie)}});var me=he((function(e){var t=this.xhr;for(var i in e=e||t.config,t.withCredentials=e.withCredentials,t.open(e.method,e.url,!1!==e.async,e.user,e.password),e.headers)t.setRequestHeader(i,e.headers[i]);t.send(e.body)})),ge=he((function(e){this.resolve(e)})),fe=he((function(e){this.reject(e)}));const pe=window.fetch;class ve{constructor(){h(this,"_resolve"),h(this,"_error"),h(this,"_next",!1),h(this,"_input"),h(this,"_init")}resolve(e){this._resolve=Promise.resolve(e)}error(e){this._error=e}next(e){this._next=!0,this._input=e.input,this._init=e.init}}class ye{constructor(){h(this,"_resolve"),h(this,"_error"),h(this,"_next",!1),h(this,"_response")}resolve(e){this._resolve=Promise.resolve(e)}error(e){this._error=e}next(e){this._next=!0,this._response=e}}let we=!1,_e=[],xe=[];const Te=(e,t=v)=>(e.onRequest&&_e.push(e.onRequest),e.onResponse&&xe.push(e.onResponse),we||((e=>{e.fetch=async(e,t)=>{for(const i of _e){const o=new ve;if(i.apply(v,[{input:e,init:t},o]),o._resolve)return o._resolve;if(o._error)throw o._error;if(!o._next)break;e=o._input,t=o._init}let i=await pe.apply(v,[e,t]);for(const e of xe){const t=new ye;if(e.apply(v,[i,t]),t._resolve)return t._resolve;if(t._error)throw t._error;if(!t._next)break;i=t._response}return i}})(t),we=!0),{unProxy:()=>{e.onRequest&&_e.splice(_e.findIndex((t=>t===e.onRequest)),1),e.onResponse&&xe.splice(xe.findIndex((t=>t===e.onResponse)),1)},unHook:()=>{t.fetch=pe,_e=[],xe=[]},originFetch:pe}),be=class e extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.EnhanceExperience.noReport)}static isTargetURL(e){return!(!e.includes("//data.bilibili.com")&&!e.includes("//data.bilivideo.com"))}hookProperties(e){Object.defineProperty(e.navigator,"sendBeacon",{value:()=>!0}),Object.defineProperties(e,{reportObserver:{get:()=>({reportCustomData:function(){}}),set(){}},reportConfig:{get:()=>({}),set(){}}})}async ajaxHook(){const t={onRequest:(t,i)=>{e.isTargetURL(t.url)?i.resolve({config:t,status:200,headers:{"Content-Type":"text/plain; charset=utf-8"},response:"ok"}):i.next(t)}},i={onRequest(t,i){const o="string"==typeof(s=t.input)?s:s instanceof URL?s.toString():s instanceof Request?s.url:"Incorrect input";var s;e.isTargetURL(o)?i.resolve(new Response("ok")):i.next(t)},onResponse(e,t){t.next(e)}};this.hookProperties(v),le(t,v),Te(i,v)}run(){if(this.logger.log("拦截日志数据上报模块开始运行"),this.config.enabled)try{this.ajaxHook()}catch(e){this.logger.error("拦截日志数据上报失败",e)}}};h(be,"runOnMultiplePages",!0),h(be,"runAt","document-start"),h(be,"onFrame","all"),h(be,"runAfterDefault",!1);let ke=be;class Ce extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.EnhanceExperience.noSleep)}run(){this.logger.log("屏蔽挂机检测模块开始运行"),this.config.enabled&&setInterval((()=>{document.dispatchEvent(new MouseEvent("mousemove"))}),3e5)}}h(Ce,"runOnMultiplePages",!0),h(Ce,"runAt","window-load"),h(Ce,"runAfterDefault",!1);class Ve extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.EnhanceExperience.invisibility)}run(){this.logger.log("隐身入场模块开始运行"),this.config.enabled&&le({onRequest:(e,t)=>{e.url.includes("//api.live.bilibili.com/xlive/web-room/v1/index/getInfoByUser")?(e.url=e.url.replace("not_mock_enter_effect=0","not_mock_enter_effect=1"),t.next(e)):e.url.includes("//live-trace.bilibili.com/xlive/data-interface/v1/x25Kn")?t.resolve({config:e,status:200,headers:{"Content-Type":"application/json; charset=utf-8"},response:"ok"}):t.next(e)}},v)}}h(Ve,"runOnMultiplePages",!0),h(Ve,"runAt","document-start"),h(Ve,"runAfterDefault",!1),h(Ve,"onFrame","all");class Se extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.RemoveElement.removePKBox)}removePKNode(){m("#awesome-pk-vm { display: none !important }")}removePKToast(){const e=["主播即将结束PK","连线断开中"];new MutationObserver((t=>{for(const i of t)i.addedNodes.forEach((t=>{t instanceof HTMLElement&&t.classList.contains("link-toast")&&e.some((e=>{var i;return null==(i=t.textContent)?void 0:i.includes(e)}))&&(t.style.display="none")}))})).observe(document.body,{childList:!0})}async run(){this.logger.log("移除大乱斗元素模块开始运行"),this.config.enabled&&(this.removePKNode(),this.removePKToast())}}h(Se,"runOnMultiplePages",!0);class Ne extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.RemoveElement.removeLiveWaterMark)}async run(){this.logger.log("移除直播间水印模块开始运行"),this.config.enabled&&m(".web-player-icon-roomStatus { display: none !important }")}}h(Ne,"runOnMultiplePages",!0);class Pe extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.RemoveElement.removeShopPopover)}async run(){this.logger.log("移除直播间小黄车弹窗模块开始运行"),this.config.enabled&&m(".shop-popover { display: none !important }")}}h(Pe,"runOnMultiplePages",!0);class De extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.RemoveElement.removeGiftPopover)}async run(){this.logger.log("移除礼物赠送提示弹窗模块开始运行"),this.config.enabled&&m(".function-card { display: none !important }")}}h(De,"runOnMultiplePages",!0);class Be extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.RemoveElement.removeGameParty)}async run(){this.logger.log("移除直播间幻星派对标志模块开始运行"),this.config.enabled&&m("#game-id { display: none !important }")}}h(Be,"runOnMultiplePages",!0);const Me=Object.freeze(Object.defineProperty({__proto__:null,DailyTask_LiveTask_DanmuTask:class extends U{constructor(){super(...arguments),h(this,"medalTasksConfig",this.moduleStore.moduleConfig.DailyTasks.LiveTasks.medalTasks),h(this,"config",this.medalTasksConfig.danmu)}set status(e){this.moduleStore.moduleStatus.DailyTasks.LiveTasks.medalTasks.danmu=e}getRoomidList(){const e=C();return e.filteredFansMedals?e.filteredFansMedals.filter((e=>e.medal.level<20&&910884!=e.room_info.room_id&&(this.medalTasksConfig.isWhiteList?this.medalTasksConfig.roomidList.includes(e.room_info.room_id):!this.medalTasksConfig.roomidList.includes(e.room_info.room_id)))).map((e=>e.room_info.room_id)).slice(0,199):(this.status="error",null)}async sendDanmu(e,t){try{const i=await O.sendMsg(e,t);this.logger.log(`BAPI.live.sendMsg(${e}, ${t})`,i),0===i.code?this.logger.log(`在直播间 ${t} 发送弹幕 ${e} 成功`):this.logger.error(`在直播间 ${t} 发送弹幕 ${e} 失败`,i.message)}catch(i){this.logger.error(`在直播间 ${t} 发送弹幕 ${e} 出错`,i)}}async run(){if(this.logger.log("发送弹幕模块开始运行"),this.config.enabled)if(B(this.config._lastCompleteTime))E(0,0,0,5)?this.logger.log("昨天的发送弹幕任务已经完成过了，等到今天的00:05再执行"):(this.logger.log("今天已经完成过发送弹幕任务了"),this.status="done");else{this.status="running";const e=this.getRoomidList();if(e){const t=this.config.list;for(let i=0;i<e.length;i++){const o=t[i%t.length];await this.sendDanmu(o,e[i]),await S(2e3)}this.config._lastCompleteTime=L(),this.status="done",this.logger.log("发送弹幕任务已完成")}}const e=M();setTimeout((()=>this.run()),e.ms),this.logger.log("距离发送弹幕模块下次运行时间:",e.str)}},DailyTask_LiveTask_LikeTask:class extends U{constructor(){super(...arguments),h(this,"medalTasksConfig",this.moduleStore.moduleConfig.DailyTasks.LiveTasks.medalTasks),h(this,"config",this.medalTasksConfig.like)}set status(e){this.moduleStore.moduleStatus.DailyTasks.LiveTasks.medalTasks.like=e}getRoomidUidList(){const e=C();return e.filteredFansMedals?e.filteredFansMedals.filter((e=>(!!this.config.includeHighLevelMedals||e.medal.level<20)&&(this.medalTasksConfig.isWhiteList?this.medalTasksConfig.roomidList.includes(e.room_info.room_id):!this.medalTasksConfig.roomidList.includes(e.room_info.room_id)))).map((e=>[e.room_info.room_id,e.medal.target_id])).slice(0,199):(this.status="error",null)}async like(e,t){try{const i=await O.likeReport(e,t);this.logger.log(`BAPI.live.likeReport(${e}, ${t})`,i),0===i.code?this.logger.log(`给主播点赞 房间号 = ${e} 主播UID = ${t} 成功`):this.logger.error(`给主播点赞 房间号 = ${e} 主播UID = ${t} 失败`,i.message)}catch(i){this.logger.error(`给主播点赞 房间号 = ${e} 主播UID = ${t} 出错`,i)}}async run(){if(this.logger.log("给主播点赞模块开始运行"),this.config.enabled)if(B(this.config._lastCompleteTime))E(0,0,0,5)?this.logger.log("昨天的给主播点赞任务已经完成过了，等到今天的00:05再执行"):(this.logger.log("今天已经完成过给主播点赞任务了"),this.status="done");else{this.status="running";const e=this.getRoomidUidList();if(e){for(const[t,i]of e)await this.like(t,i),await S(2e3);this.config._lastCompleteTime=L(),this.status="done",this.logger.log("给主播点赞任务已完成")}}const e=M();setTimeout((()=>this.run()),e.ms),this.logger.log("距离给主播点赞模块下次运行时间:",e.str)}},DailyTask_LiveTask_SignTask:class extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.DailyTasks.LiveTasks.sign)}set status(e){this.moduleStore.moduleStatus.DailyTasks.LiveTasks.sign=e}async getSignInfo(){try{const e=await O.getSignInfo();return this.logger.log("BAPI.live.getSignInfo response",e),0===e.code?e.data:(this.logger.error("获取直播签到信息失败",e.message),null)}catch(e){return this.logger.error("获取直播签到信息出错",e),null}}async sign(){try{const e=await O.doSign();if(this.logger.log("BAPI.live.doSign response",e),0===e.code){this.logger.log("直播签到成功，获得奖励：",e.data.text),this.config._lastCompleteTime=L(),this.status="done",this.logger.log("直播签到任务已完成");const t=G(".checkin-btn");t&&t.remove()}else this.logger.error("直播签到失败",e.message),this.status="error"}catch(e){this.logger.error("执行直播签到任务出错",e),this.status="error"}}async run(){if(this.logger.log("直播签到模块开始运行"),this.config.enabled)if(B(this.config._lastCompleteTime))E(0,0,0,5)?this.logger.log("昨天的直播签到任务已经完成过了，等到今天的00:05再执行"):(this.logger.log("今天已经完成过直播签到任务了"),this.status="done");else{this.status="running";const e=await this.getSignInfo();e?0===e.status?await this.sign():(this.config._lastCompleteTime=L(),this.status="done"):await this.sign()}const e=M();setTimeout((()=>this.run()),e.ms),this.logger.log("距离直播签到模块下次运行时间:",e.str)}},DailyTask_LiveTask_WatchTask:X,DailyTask_MainSiteTask_CoinTask:class extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.DailyTasks.MainSiteTasks.coin),h(this,"MAX_COIN",1)}set status(e){this.moduleStore.moduleStatus.DailyTasks.MainSiteTasks.coin=e}getDynamicVideoIds(){const e=C();return e.dynamicVideos?e.dynamicVideos.map((e=>{const t=e.modules.module_dynamic.major.archive;return{aid:t.aid,bvid:t.bvid}})):(this.status="error",null)}async getVideoCoinInfo(e,t){try{const i=await $.videoRelation(e,t);return this.logger.log(`BAPI.main.videoRelation(${e}, ${t}) response`,i),0===i.code?i.data.coin:(this.logger.error(`获取视频投币信息失败 aid = ${e} bvid = ${t}`,i.message),0)}catch(i){return this.logger.error(`获取视频投币信息出错 aid = ${e} bvid = ${t}`,i),0}}async coinDynamicVideos(e){const t=this.getDynamicVideoIds();if(t)for(const{aid:i,bvid:o}of t){const t=await this.getVideoCoinInfo(i,o),s=this.MAX_COIN-t;if(s>0){const t=Math.min(s,e),o=await this.coin(i,t);if(0===o){if(0===(e-=t)){this.logger.log("每日投币任务已完成"),this.config._lastCompleteTime=L(),this.status="done";break}}else if(1===o){this.status="error";break}}}}async coin(e,t){try{const i=await $.coinAdd(e,t);return this.logger.log(`BAPI.main.coinAdd(${e}) response`,i),0===i.code?(this.logger.log(`投币成功 视频aid = ${e} 投币数量num = ${t}`),0):-104===i.code?(this.logger.warn("硬币余额不足，每日投币任务终止"),1):(this.logger.error(`投币失败 视频aid = ${e} 投币数量num = ${t}`,i.message),2)}catch(i){return this.logger.error(`投币出错 视频aid = ${e} 投币数量num = ${t}`,i),3}}async run(){if(this.logger.log("每日投币模块开始运行"),this.config.enabled){const e=C();if(B(this.config._lastCompleteTime))E(0,0,0,5)?this.logger.log("昨天的每日投币任务已经完成过了，等到今天的00:05再执行"):(this.logger.log("今天已经完成过每日投币任务了"),this.status="done");else if(this.status="running",e.dailyRewardInfo){const t=e.dailyRewardInfo.coins/10;if(t<this.config.num){const e=this.config.num-t;e>(C().userInfo.money??5)?(this.logger.log("硬币余额不足，不执行每日投币任务"),this.status="done"):await this.coinDynamicVideos(e)}else this.config._lastCompleteTime=L(),this.status="done",this.logger.log("每日投币任务已完成")}}const e=M();setTimeout((()=>this.run()),e.ms),this.logger.log("距离每日投币模块下次运行时间:",e.str)}},DailyTask_MainSiteTask_LoginTask:class extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.DailyTasks.MainSiteTasks.login)}set status(e){this.moduleStore.moduleStatus.DailyTasks.MainSiteTasks.login=e}async login(){return this.logger.log("每日登录任务已完成"),this.config._lastCompleteTime=L(),this.status="done",Promise.resolve()}async run(){if(this.logger.log("每日登录模块开始运行"),this.config.enabled){const e=C();B(this.config._lastCompleteTime)?E(0,0,0,5)?this.logger.log("昨天的每日登录任务已经完成过了，等到今天的00:05再执行"):(this.logger.log("今天已经完成过每日登录任务了"),this.status="done"):(this.status="running",e.dailyRewardInfo&&!e.dailyRewardInfo.login?await this.login():(this.config._lastCompleteTime=L(),this.status="done"))}const e=M();setTimeout((()=>this.run()),e.ms),this.logger.log("距离每日登录模块下次运行时间:",e.str)}},DailyTask_MainSiteTask_ShareTask:class extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.DailyTasks.MainSiteTasks.share)}set status(e){this.moduleStore.moduleStatus.DailyTasks.MainSiteTasks.share=e}getAid(){const e=C();return e.dynamicVideos?e.dynamicVideos[0].modules.module_dynamic.major.archive.aid:"2"}async share(e){try{const t=await $.share(e);this.logger.log(`BAPI.main.share(${e}) response`,t),0===t.code||71e3===t.code?(this.logger.log("每日分享视频任务已完成"),this.config._lastCompleteTime=L(),this.status="done"):(this.logger.error("分享视频失败",t.message),this.status="error")}catch(e){this.logger.error("执行每日分享视频任务出错",e),this.status="error"}}async run(){if(this.logger.log("每日分享视频模块开始运行"),this.config.enabled){const e=C();if(B(this.config._lastCompleteTime))E(0,0,0,5)?this.logger.log("昨天的每日分享任务已经完成过了，等到今天的00:05再执行"):(this.logger.log("今天已经完成过每日分享任务了"),this.status="done");else if(this.status="running",e.dailyRewardInfo&&!e.dailyRewardInfo.share){const e=this.getAid();await this.share(e)}else this.config._lastCompleteTime=L(),this.status="done",this.logger.log("每日分享视频任务已完成")}const e=M();setTimeout((()=>this.run()),e.ms),this.logger.log("距离每日分享视频模块下次运行时间:",e.str)}},DailyTask_MainSiteTask_WatchTask:class extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.DailyTasks.MainSiteTasks.watch)}set status(e){this.moduleStore.moduleStatus.DailyTasks.MainSiteTasks.watch=e}getAid(){const e=C();return i.isEmpty(e.dynamicVideos)?"2":e.dynamicVideos[0].modules.module_dynamic.major.archive.aid}async watch(e){try{const t=await $.videoHeartbeat(e);this.logger.log(`BAPI.main.videoHeartbeat(${e}) response`,t),0===t.code?(this.logger.log("每日观看视频任务已完成"),this.config._lastCompleteTime=L(),this.status="done"):(this.logger.error("发送观看视频心跳失败",t.message),this.status="error")}catch(e){this.logger.error("执行每日观看视频任务出错",e),this.status="error"}}async run(){if(this.logger.log("每日观看视频模块开始运行"),this.config.enabled){const e=C();if(B(this.config._lastCompleteTime))E(0,0,0,5)?this.logger.log("昨天的每日观看视频任务已经完成过了，等到今天的00:05再执行"):(this.logger.log("今天已经完成过每日观看视频任务了"),this.status="done");else if(this.status="running",e.dailyRewardInfo&&!e.dailyRewardInfo.watch){const e=this.getAid();await this.watch(e)}else this.config._lastCompleteTime=L(),this.status="done",this.logger.log("每日观看视频任务已完成")}const e=M();setTimeout((()=>this.run()),e.ms),this.logger.log("距离每日观看视频模块下次运行时间:",e.str)}},DailyTask_OtherTask_CoinToSilverTask:class extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.DailyTasks.OtherTasks.coinToSilver)}set status(e){this.moduleStore.moduleStatus.DailyTasks.OtherTasks.coinToSilver=e}async exchange(){try{const e=await O.coin2silver(this.config.num);this.logger.log(`BAPI.live.coin2silver{${this.config.num}} response`,e),0===e.code?(this.logger.log("硬币换银瓜子已完成，获得银瓜子:",e.data.silver),this.config._lastCompleteTime=L(),this.status="done"):(this.logger.error("硬币换银瓜子失败",e.message),this.status="error")}catch(e){this.logger.error("硬币换银瓜子出错",e),this.status="error"}}async run(){this.logger.log("硬币换银瓜子模块开始运行"),this.config.enabled&&(B(this.config._lastCompleteTime)?E(0,0,0,5)?this.logger.log("昨天的硬币换银瓜子任务已经完成过了，等到今天的00:05再执行"):(this.logger.log("今天已经完成过硬币换银瓜子任务了"),this.status="done"):(this.status="running",await this.exchange()));const e=M();setTimeout((()=>this.run()),e.ms),this.logger.log("硬币换银瓜子模块下次运行时间:",e.str)}},DailyTask_OtherTask_GetYearVipPrivilegeTask:class extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.DailyTasks.OtherTasks.getYearVipPrivilege)}set status(e){this.moduleStore.moduleStatus.DailyTasks.OtherTasks.getYearVipPrivilege=e}async myPrivilege(){try{const e=await $.vip.myPrivilege();if(this.logger.log("BAPI.main.vip.myPrivilege response",e),0===e.code)return e.data.list;this.logger.error("获取年度大会员权益信息失败",e.message),this.status="error"}catch(e){this.logger.error("获取年度大会员权益信息出错",e),this.status="error"}}async receivePrivilege(e){try{const t=await $.vip.receivePrivilege(e);this.logger.log(`BAPI.main.vip.receivePrivilege(${e}) response`,t),0===t.code?this.logger.log(`领取年度大会员权益（type = ${e}）成功`):this.logger.error(`领取年度大会员权益（type = ${e}）失败`,t.message)}catch(t){this.logger.error(`领取年度大会员权益（type = ${e}）出错`,t)}}isYearVip(){const e=C().userInfo;return!(!e||1!==e.vip.status||2!==e.vip.type)||(this.logger.log("当前账号不是年度大会员，不领取权益"),!1)}async run(){if(this.logger.log("领取年度大会员权益模块开始运行"),this.config.enabled){if(this.isYearVip())if(I()>=this.config._nextReceiveTime){this.status="running";const e=await this.myPrivilege();if(e){for(const t of e)2===t.vip_type?0===t.state?await this.receivePrivilege(t.type):this.logger.log(`该权益（type = ${t.type}）已经领取过了`):this.logger.warn("发现不属于年度大会员的权益",t);this.status="done",this.config._nextReceiveTime=Math.max(...e.map((e=>e.period_end_unix)))}}else{const e=this.config._nextReceiveTime-I();e<86400?(this.logger.log("领取年度大会员权益模块下次运行时间:",s.DateTime.fromSeconds(this.config._nextReceiveTime).toJSDate()),setTimeout((()=>this.run()),1e3*e)):this.logger.log("距离下次领取年度大会员权益的时间超过一天，不计划下次运行")}}else{const e=M(0,0);setTimeout((()=>this.run()),e.ms),this.logger.log("领取年度大会员权益模块下次运行时间:",e.str)}}},DailyTask_OtherTask_GroupSignTask:class extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.DailyTasks.OtherTasks.groupSign)}set status(e){this.moduleStore.moduleStatus.DailyTasks.OtherTasks.groupSign=e}async getGroupidOwneruidList(){try{const e=await j.myGroups();if(this.logger.log("BAPI.vc.myGroups response",e),0===e.code)return e.data.list.map((e=>[e.group_id,e.owner_uid]));this.logger.error("获取应援团信息失败",e.message),this.status="error"}catch(e){this.logger.error("获取应援团信息出错",e),this.status="error"}}async sign(e,t){try{const i=await j.signIn(e,t);this.logger.log(`BAPI.vc.signIn(${e}, ${t}) response`,i),0===i.code?this.logger.log(`应援团签到 应援团ID = ${e} 拥有者UID = ${t} 成功, 粉丝勋章亲密度+${i.data.add_num}`):this.logger.error(`应援团签到 应援团ID = ${e} 拥有者UID = ${t} 失败`,i.message)}catch(i){this.logger.error(`应援团签到 应援团ID = ${e} 拥有者UID = ${t} 出错`,i)}}async run(){if(this.logger.log("应援团签到模块开始运行"),this.config.enabled)if(B(this.config._lastCompleteTime,8,5))E(0,0,8,5)?this.logger.log("昨天的应援团签到任务已经完成过了，等到今天早上八点零五分再次执行"):(this.logger.log("今天已经完成过应援团签到任务了"),this.status="done");else{this.status="running";const e=await this.getGroupidOwneruidList();if(e){for(const[t,i]of e)await this.sign(t,i),await S(2e3);this.config._lastCompleteTime=L(),this.logger.log("应援团签到任务已完成"),this.status="done"}}const e=M(8,5);setTimeout((()=>this.run()),e.ms),this.logger.log("距离应援团签到模块下次运行时间:",e.str)}},DailyTask_OtherTask_SilverToCoinTask:class extends U{constructor(){super(...arguments),h(this,"config",this.moduleStore.moduleConfig.DailyTasks.OtherTasks.silverToCoin)}set status(e){this.moduleStore.moduleStatus.DailyTasks.OtherTasks.silverToCoin=e}async exchange(){try{const e=await O.silver2coin();this.logger.log("BAPI.live.silver2coin response",e),0===e.code?(this.logger.log("银瓜子换硬币已完成，获得硬币:",e.data.coin),this.config._lastCompleteTime=L(),this.status="done"):403===e.code?(this.logger.log("每天最多只能用银瓜子兑换1个硬币"),this.config._lastCompleteTime=L(),this.status="done"):(this.logger.error("银瓜子换硬币失败",e.message),this.status="error")}catch(e){this.logger.error("银瓜子换硬币出错",e),this.status="error"}}run(){this.logger.log("银瓜子换硬币模块开始运行"),this.config.enabled&&(B(this.config._lastCompleteTime)?E(0,0,0,5)?this.logger.log("昨天的银瓜子换硬币任务已经完成过了，等到今天的00:05再执行"):(this.logger.log("今天已经完成过银瓜子换硬币任务了"),this.status="done"):(this.status="running",this.exchange()));const e=M();setTimeout((()=>this.run()),e.ms),this.logger.log("银瓜子换硬币模块下次运行时间:",e.str)}},EnhanceExperience_BanP2P:Q,EnhanceExperience_Invisibility:Ve,EnhanceExperience_NoReport:ke,EnhanceExperience_NoSleep:Ce,EnhanceExperience_SwitchLiveStreamQuality:J,RemoveElement_RemoveGameParty:Be,RemoveElement_RemoveGiftPopover:De,RemoveElement_RemoveLiveWaterMark:Ne,RemoveElement_RemovePKBox:Se,RemoveElement_RemoveShopPopover:Pe},Symbol.toStringTag,{value:"Module"}));function Ee(e){const t={all:i=(i=e)||new Map,on:function(e,t){var o=i.get(e);o?o.push(t):i.set(e,[t])},off:function(e,t){var o=i.get(e);o&&(t?o.splice(o.indexOf(t)>>>0,1):i.set(e,[]))},emit:function(e,t){var o=i.get(e);o&&o.slice().map((function(e){e(t)})),(o=i.get("*"))&&o.slice().map((function(i){i(e,t)}))}};var i;return{...t,once(e,i){t.on(e,(function o(s){t.off(e,o),i(s)}))}}}const Ie=t.defineStore("cache",(()=>{const t=e.reactive(w.getCache()),i=e.ref("Main");return e.watch(t,(e=>w.setCache(e))),{cache:t,currentScriptType:i,startMainBLTHAliveHeartBeat:function(){t.lastAliveHeartBeatTime=Date.now();const e=setInterval((()=>t.lastAliveHeartBeatTime=Date.now()),5e3);window.addEventListener("unload",(()=>{clearInterval(e),t.lastAliveHeartBeatTime=0}))},checkCurrentScriptType:function(){0!==t.lastAliveHeartBeatTime&&Date.now()-t.lastAliveHeartBeatTime<8e3?null===sessionStorage.getItem("main_blth_flag")?i.value="Other":i.value="SubMain":(i.value="Main",sessionStorage.setItem("main_blth_flag","🚩"))}}})),Le={DailyTasks:{MainSiteTasks:{login:"",watch:"",coin:"",share:""},LiveTasks:{sign:"",medalTasks:{danmu:"",like:"",watch:""}},OtherTasks:{groupSign:"",silverToCoin:"",coinToSilver:"",getYearVipPrivilege:""}}},Re=[],Oe=t.defineStore("module",(()=>{const t=e.reactive(w.getModuleConfig()),o=Ee(),s=e.reactive(Le);return e.watch(t,i.debounce((e=>w.setModuleConfig(e)),250,{leading:!0,trailing:!0})),function e(){setTimeout((()=>{P(s,((e,t)=>{i.set(s,t,"")})),e()}),M(0,0).ms)}(),{moduleConfig:t,emitter:o,moduleStatus:s,loadModules:function(e){const t=Ie(),i=new H("ModuleStore_LoadModules");if("unknown"===e)for(const[e,i]of Object.entries(Me))("all"===i.onFrame||"top"===i.onFrame&&K())&&(i.runOnMultiplePages||"Other"!==t.currentScriptType)&&(i.runAfterDefault||(D(i.runAt).then((()=>new i(e).run())),Re.push(e)));else{const e=function(){const e=Ie(),t=[];for(const[i,o]of Object.entries(F))(o.runOnMultiplePages||"Other"!==e.currentScriptType)&&t.push(new o(i).run());return Promise.all(t)}();for(const[o,s]of Object.entries(Me))("target"===s.onFrame||"top"===s.onFrame&&K()&&!Re.includes(o)||"all"===s.onFrame&&!Re.includes(o))&&(s.runOnMultiplePages||"Other"!==t.currentScriptType)&&D(s.runAt).then((async()=>{try{s.runAfterDefault&&await e,new s(o).run()}catch(e){i.error(`运行默认模块时出错，模块 ${o} 不运行:`,e)}}))}}}})),Ae=e.defineComponent({__name:"MainSiteTasks",setup(t){const i=Oe(),o=i.moduleConfig.DailyTasks.MainSiteTasks,s=i.moduleStatus.DailyTasks.MainSiteTasks;return(t,i)=>{const a=e.resolveComponent("el-switch"),n=e.resolveComponent("Info"),r=e.resolveComponent("TaskStatus"),l=e.resolveComponent("el-space"),c=e.resolveComponent("el-row"),d=e.resolveComponent("el-option"),u=e.resolveComponent("el-select"),h=e.resolveComponent("el-text"),m=e.resolveComponent("el-divider"),g=e.resolveComponent("el-link");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(c,null,{default:e.withCtx((()=>[e.createVNode(l,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(o).login.enabled,"onUpdate:modelValue":i[0]||(i[0]=t=>e.unref(o).login.enabled=t),"active-text":"每日登录"},null,8,["modelValue"]),e.createVNode(n,{id:"DailyTasks.MainSiteTasks.login"}),e.createVNode(r,{status:e.unref(s).login},null,8,["status"])])),_:1})])),_:1}),e.createVNode(c,null,{default:e.withCtx((()=>[e.createVNode(l,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(o).watch.enabled,"onUpdate:modelValue":i[1]||(i[1]=t=>e.unref(o).watch.enabled=t),"active-text":"每日观看视频"},null,8,["modelValue"]),e.createVNode(n,{id:"DailyTasks.MainSiteTasks.watch"}),e.createVNode(r,{status:e.unref(s).watch},null,8,["status"])])),_:1})])),_:1}),e.createVNode(c,null,{default:e.withCtx((()=>[e.createVNode(l,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(o).coin.enabled,"onUpdate:modelValue":i[2]||(i[2]=t=>e.unref(o).coin.enabled=t),"active-text":"每日投币"},null,8,["modelValue"]),e.createVNode(u,{modelValue:e.unref(o).coin.num,"onUpdate:modelValue":i[3]||(i[3]=t=>e.unref(o).coin.num=t),placeholder:"Select",style:{width:"64px"}},{default:e.withCtx((()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(5,(t=>e.createVNode(d,{key:t,label:t,value:t},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),e.createVNode(h,null,{default:e.withCtx((()=>[e.createTextVNode("个")])),_:1}),e.createVNode(n,{id:"DailyTasks.MainSiteTasks.coin"}),e.createVNode(r,{status:e.unref(s).coin},null,8,["status"])])),_:1})])),_:1}),e.createVNode(c,null,{default:e.withCtx((()=>[e.createVNode(l,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(o).share.enabled,"onUpdate:modelValue":i[4]||(i[4]=t=>e.unref(o).share.enabled=t),"active-text":"每日分享视频"},null,8,["modelValue"]),e.createVNode(n,{id:"DailyTasks.MainSiteTasks.share"}),e.createVNode(r,{status:e.unref(s).share},null,8,["status"])])),_:1})])),_:1}),e.createVNode(m),e.createVNode(c,null,{default:e.withCtx((()=>[e.createVNode(h,null,{default:e.withCtx((()=>[e.createTextVNode("  主站每日任务的完成情况可在")])),_:1}),e.createVNode(g,{class:"el-link-va-baseline",rel:"noreferrer",type:"primary",href:"https://account.bilibili.com/account/home",target:"_blank"},{default:e.withCtx((()=>[e.createTextVNode("个人中心")])),_:1}),e.createVNode(h,null,{default:e.withCtx((()=>[e.createTextVNode("查看。数据更新可能有一定的延时。")])),_:1})])),_:1})])}}}),$e=(t=>(e.pushScopeId("data-v-a6281aa6"),t=t(),e.popScopeId(),t))((()=>e.createElementVNode("br",null,null,-1))),je={class:"avatar-wrap"},He=T(e.defineComponent({__name:"LiveTasks",setup(t){const i=Oe(),s=C(),a=i.moduleConfig.DailyTasks.LiveTasks,r=i.moduleStatus.DailyTasks.LiveTasks,l=e.ref(!1),c=e.computed((()=>a.medalTasks.danmu.list.map((e=>({content:e}))))),d=()=>{n.ElMessageBox.prompt("请输入新增的弹幕内容","新增弹幕",{confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:/^.{1,30}$/,inputErrorMessage:"弹幕内容不得为空且长度不能超过30",lockScroll:!1}).then((({value:e})=>{a.medalTasks.danmu.list.push(e)})).catch((()=>{}))},u=e.ref(!1),h=e.computed((()=>{var e;return null==(e=s.filteredFansMedals)?void 0:e.map((e=>({avatar:e.anchor_info.avatar,nick_name:e.anchor_info.nick_name,medal_name:e.medal.medal_name,medal_level:e.medal.level,roomid:e.room_info.room_id})))})),m=e.ref(!1);let g=!0;const f=()=>{if(u.value=!u.value,g)if(s.fansMedals)y(h.value);else{m.value=!0;const t=e.watch(h,(e=>{e&&(t(),g=!1,y(h.value),m.value=!1)}));i.emitter.emit("Default_FansMedals",{module:"LiveTasks"})}},p=e.ref();let v=!1;const y=t=>{if(v=!0,t){const i=e.watch((()=>p.value),(e=>{setTimeout((()=>i()),0),e&&a.medalTasks.roomidList.forEach((i=>e.toggleRowSelection(t.find((e=>e.roomid===i)),!0)))}),{immediate:!0})}v=!1};function w(e){v||(a.medalTasks.roomidList=e.map((e=>e.roomid)))}return(t,i)=>{const s=e.resolveComponent("el-switch"),g=e.resolveComponent("Info"),v=e.resolveComponent("TaskStatus"),y=e.resolveComponent("el-space"),_=e.resolveComponent("el-row"),x=e.resolveComponent("el-divider"),T=e.resolveComponent("SemiSelect"),b=e.resolveComponent("el-icon"),k=e.resolveComponent("el-button"),C=e.resolveComponent("el-option"),V=e.resolveComponent("el-select"),S=e.resolveComponent("el-text"),N=e.resolveComponent("el-link"),P=e.resolveComponent("el-table-column"),D=e.resolveComponent("el-dialog"),B=e.resolveComponent("el-image"),M=e.resolveDirective("loading");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(_,null,{default:e.withCtx((()=>[e.createVNode(y,{wrap:""},{default:e.withCtx((()=>[e.createVNode(s,{modelValue:e.unref(a).sign.enabled,"onUpdate:modelValue":i[0]||(i[0]=t=>e.unref(a).sign.enabled=t),"active-text":"直播签到"},null,8,["modelValue"]),e.createVNode(g,{id:"DailyTasks.LiveTasks.sign"}),e.createVNode(v,{status:e.unref(r).sign},null,8,["status"])])),_:1})])),_:1}),e.createVNode(x),e.createVNode(_,null,{default:e.withCtx((()=>[e.createVNode(y,{wrap:""},{default:e.withCtx((()=>[e.createVNode(s,{modelValue:e.unref(a).medalTasks.like.enabled,"onUpdate:modelValue":i[1]||(i[1]=t=>e.unref(a).medalTasks.like.enabled=t),"active-text":"给主播点赞"},null,8,["modelValue"]),e.createVNode(g,{id:"DailyTasks.LiveTasks.medalTasks.like"}),e.createVNode(v,{status:e.unref(r).medalTasks.like},null,8,["status"])])),_:1})])),_:1}),e.createVNode(_,null,{default:e.withCtx((()=>[e.createVNode(y,{wrap:""},{default:e.withCtx((()=>[e.createVNode(b,null,{default:e.withCtx((()=>[e.createVNode(T)])),_:1}),e.createVNode(s,{modelValue:e.unref(a).medalTasks.like.includeHighLevelMedals,"onUpdate:modelValue":i[2]||(i[2]=t=>e.unref(a).medalTasks.like.includeHighLevelMedals=t),"active-text":"包含等级≥20的粉丝勋章"},null,8,["modelValue"])])),_:1})])),_:1}),e.createVNode(_,null,{default:e.withCtx((()=>[e.createVNode(y,{wrap:""},{default:e.withCtx((()=>[e.createVNode(s,{modelValue:e.unref(a).medalTasks.danmu.enabled,"onUpdate:modelValue":i[3]||(i[3]=t=>e.unref(a).medalTasks.danmu.enabled=t),"active-text":"发送弹幕"},null,8,["modelValue"]),e.createVNode(k,{type:"primary",size:"small",icon:e.unref(o.Edit),onClick:i[4]||(i[4]=e=>l.value=!l.value)},{default:e.withCtx((()=>[e.createTextVNode("编辑弹幕")])),_:1},8,["icon"]),e.createVNode(g,{id:"DailyTasks.LiveTasks.medalTasks.danmu"}),e.createVNode(v,{status:e.unref(r).medalTasks.danmu},null,8,["status"])])),_:1})])),_:1}),e.createVNode(_,null,{default:e.withCtx((()=>[e.createVNode(y,{wrap:""},{default:e.withCtx((()=>[e.createVNode(s,{modelValue:e.unref(a).medalTasks.watch.enabled,"onUpdate:modelValue":i[5]||(i[5]=t=>e.unref(a).medalTasks.watch.enabled=t),"active-text":"观看直播"},null,8,["modelValue"]),e.createVNode(V,{modelValue:e.unref(a).medalTasks.watch.time,"onUpdate:modelValue":i[6]||(i[6]=t=>e.unref(a).medalTasks.watch.time=t),placeholder:"Select",style:{width:"70px"}},{default:e.withCtx((()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(24,(t=>e.createVNode(C,{key:t,label:5*t,value:5*t},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),e.createVNode(S,null,{default:e.withCtx((()=>[e.createTextVNode("分钟")])),_:1}),e.createVNode(g,{id:"DailyTasks.LiveTasks.medalTasks.watch"}),e.createVNode(v,{status:e.unref(r).medalTasks.watch},null,8,["status"])])),_:1})])),_:1}),e.createVNode(_,null,{default:e.withCtx((()=>[e.createVNode(y,{wrap:""},{default:e.withCtx((()=>[e.createVNode(s,{modelValue:e.unref(a).medalTasks.isWhiteList,"onUpdate:modelValue":i[7]||(i[7]=t=>e.unref(a).medalTasks.isWhiteList=t),"active-text":"白名单","inactive-text":"黑名单"},null,8,["modelValue"]),e.createVNode(k,{type:"primary",size:"small",icon:e.unref(o.Edit),onClick:f},{default:e.withCtx((()=>[e.createTextVNode("编辑名单")])),_:1},8,["icon"]),e.createVNode(g,{id:"DailyTasks.LiveTasks.medalTasks.list"})])),_:1})])),_:1}),e.createVNode(x),e.createVNode(_,null,{default:e.withCtx((()=>[e.createVNode(S,null,{default:e.withCtx((()=>[e.createTextVNode("直播任务相关信息可在")])),_:1}),e.createVNode(N,{class:"el-link-va-baseline",rel:"noreferrer",type:"primary",href:"https://link.bilibili.com/p/help/index#/audience-fans-medal",target:"_blank"},{default:e.withCtx((()=>[e.createTextVNode("帮助中心")])),_:1}),e.createVNode(S,null,{default:e.withCtx((()=>[e.createTextVNode("查看。")])),_:1})])),_:1}),$e,e.createVNode(_,null,{default:e.withCtx((()=>[e.createVNode(S,{tag:"b"},{default:e.withCtx((()=>[e.createTextVNode("注意：")])),_:1})])),_:1}),e.createVNode(_,null,{default:e.withCtx((()=>[e.createVNode(S,null,{default:e.withCtx((()=>[e.createTextVNode("  由于每天能通过完成任务获得亲密度的粉丝勋章数量有限，脚本默认仅为最多199个等级小于20的粉丝勋章完成给主播点赞，发送弹幕，观看直播任务。在脚本执行任务期间观看未执行任务的粉丝勋章对应直播间直播可能导致今天无法获取任何亲密度。")])),_:1})])),_:1}),e.createVNode(D,{modelValue:l.value,"onUpdate:modelValue":i[8]||(i[8]=e=>l.value=e),title:"编辑弹幕内容","lock-scroll":!1,width:"40%"},{footer:e.withCtx((()=>[e.createVNode(k,{type:"primary",onClick:d},{default:e.withCtx((()=>[e.createTextVNode("新增弹幕")])),_:1})])),default:e.withCtx((()=>[e.createVNode(e.unref(n.ElTable),{data:c.value,"max-height":"500"},{default:e.withCtx((()=>[e.createVNode(P,{type:"index",width:"50"}),e.createVNode(P,{prop:"content",label:"弹幕内容"}),e.createVNode(P,{label:"操作",width:"220",align:"center"},{default:e.withCtx((t=>[e.createVNode(k,{text:"",icon:e.unref(o.Edit),onClick:e=>{return i=t.$index,o=t.row,void n.ElMessageBox.prompt("请输入新的弹幕内容","修改弹幕",{confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:/^.{1,30}$/,inputErrorMessage:"弹幕内容不得为空且长度不能超过30",inputValue:o.content,lockScroll:!1}).then((({value:e})=>{a.medalTasks.danmu.list[i]=e})).catch((()=>{}));var i,o}},{default:e.withCtx((()=>[e.createTextVNode(" 修改 ")])),_:2},1032,["icon","onClick"]),e.createVNode(k,{text:"",icon:e.unref(o.Delete),type:"danger",onClick:e=>{return i=t.$index,void(1!==a.medalTasks.danmu.list.length?a.medalTasks.danmu.list.splice(i,1):n.ElMessage.warning({message:"至少要有一条弹幕",appendTo:".el-dialog"}));var i}},{default:e.withCtx((()=>[e.createTextVNode(" 删除 ")])),_:2},1032,["icon","onClick"])])),_:1})])),_:1},8,["data"])])),_:1},8,["modelValue"]),e.createVNode(D,{modelValue:u.value,"onUpdate:modelValue":i[9]||(i[9]=e=>u.value=e),title:"编辑粉丝勋章名单","lock-scroll":!1,width:"40%"},{default:e.withCtx((()=>[e.withDirectives((e.openBlock(),e.createBlock(e.unref(n.ElTable),{ref_key:"medalInfoTableRef",ref:p,data:h.value,"max-height":"500","empty-text":"没有粉丝勋章",onSelectionChange:w},{default:e.withCtx((()=>[e.createVNode(P,{type:"selection",align:"center",width:"55"}),e.createVNode(P,{prop:"avatar",label:"头像",width:"100"},{default:e.withCtx((t=>[e.createElementVNode("div",je,[e.createVNode(B,{src:t.row.avatar,loading:"lazy",referrerpolicy:"origin",class:"avatar"},{error:e.withCtx((()=>[e.createVNode(B,{src:"//i0.hdslb.com/bfs/face/member/noface.jpg",referrerpolicy:"origin",class:"avatar"})])),_:2},1032,["src"])])])),_:1}),e.createVNode(P,{prop:"nick_name",label:"昵称"}),e.createVNode(P,{prop:"medal_name",label:"粉丝勋章"}),e.createVNode(P,{prop:"medal_level",label:"等级",width:"80",sortable:""}),e.createVNode(P,{prop:"roomid",label:"房间号"},{default:e.withCtx((t=>[e.createVNode(N,{href:"https://live.bilibili.com/"+t.row.roomid+"?visit_id=",rel:"noreferrer",type:"primary",target:"_blank"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(t.row.roomid),1)])),_:2},1032,["href"])])),_:1})])),_:1},8,["data"])),[[M,m.value]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-a6281aa6"]]),Ue=e.defineComponent({__name:"OtherTasks",setup(t){const i=Oe(),o=i.moduleConfig.DailyTasks.OtherTasks,s=i.moduleStatus.DailyTasks.OtherTasks;return(t,i)=>{const a=e.resolveComponent("el-switch"),n=e.resolveComponent("Info"),r=e.resolveComponent("TaskStatus"),l=e.resolveComponent("el-space"),c=e.resolveComponent("el-row"),d=e.resolveComponent("el-text"),u=e.resolveComponent("el-option"),h=e.resolveComponent("el-select"),m=e.resolveComponent("el-divider");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(c,null,{default:e.withCtx((()=>[e.createVNode(l,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(o).groupSign.enabled,"onUpdate:modelValue":i[0]||(i[0]=t=>e.unref(o).groupSign.enabled=t),"active-text":"应援团签到"},null,8,["modelValue"]),e.createVNode(n,{id:"DailyTasks.OtherTasks.groupSign"}),e.createVNode(r,{status:e.unref(s).groupSign},null,8,["status"])])),_:1})])),_:1}),e.createVNode(c,null,{default:e.withCtx((()=>[e.createVNode(l,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(o).silverToCoin.enabled,"onUpdate:modelValue":i[1]||(i[1]=t=>e.unref(o).silverToCoin.enabled=t),"active-text":"银瓜子换硬币"},null,8,["modelValue"]),e.createVNode(n,{id:"DailyTasks.OtherTasks.silverToCoin"}),e.createVNode(r,{status:e.unref(s).silverToCoin},null,8,["status"])])),_:1})])),_:1}),e.createVNode(c,null,{default:e.withCtx((()=>[e.createVNode(l,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(o).coinToSilver.enabled,"onUpdate:modelValue":i[2]||(i[2]=t=>e.unref(o).coinToSilver.enabled=t),"active-text":"硬币换银瓜子"},null,8,["modelValue"]),e.createVNode(d,null,{default:e.withCtx((()=>[e.createTextVNode("花费硬币")])),_:1}),e.createVNode(h,{modelValue:e.unref(o).coinToSilver.num,"onUpdate:modelValue":i[3]||(i[3]=t=>e.unref(o).coinToSilver.num=t),placeholder:"Select",style:{width:"64px"}},{default:e.withCtx((()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(50,(t=>e.createVNode(u,{key:t,label:t,value:t},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),e.createVNode(d,null,{default:e.withCtx((()=>[e.createTextVNode("个")])),_:1}),e.createVNode(n,{id:"DailyTasks.OtherTasks.coinToSilver"}),e.createVNode(r,{status:e.unref(s).coinToSilver},null,8,["status"])])),_:1})])),_:1}),e.createVNode(c,null,{default:e.withCtx((()=>[e.createVNode(l,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(o).getYearVipPrivilege.enabled,"onUpdate:modelValue":i[4]||(i[4]=t=>e.unref(o).getYearVipPrivilege.enabled=t),"active-text":"领取年度大会员权益"},null,8,["modelValue"]),e.createVNode(n,{id:"DailyTasks.OtherTasks.getYearVipPrivilege"}),e.createVNode(r,{status:e.unref(s).getYearVipPrivilege},null,8,["status"])])),_:1})])),_:1}),e.createVNode(m)])}}}),ze=e.defineComponent({__name:"EnhanceExperience",setup(t){const i=Oe().moduleConfig.EnhanceExperience,o=["原画","蓝光PRO","蓝光","超清PRO","超清","高清"];return(t,s)=>{const a=e.resolveComponent("el-switch"),n=e.resolveComponent("el-option"),r=e.resolveComponent("el-select"),l=e.resolveComponent("Info"),c=e.resolveComponent("el-space"),d=e.resolveComponent("el-row"),u=e.resolveComponent("el-divider");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(d,null,{default:e.withCtx((()=>[e.createVNode(c,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(i).switchLiveStreamQuality.enabled,"onUpdate:modelValue":s[0]||(s[0]=t=>e.unref(i).switchLiveStreamQuality.enabled=t),"active-text":"自动切换画质"},null,8,["modelValue"]),e.createVNode(r,{modelValue:e.unref(i).switchLiveStreamQuality.qualityDesc,"onUpdate:modelValue":s[1]||(s[1]=t=>e.unref(i).switchLiveStreamQuality.qualityDesc=t),placeholder:"Select",style:{width:"110px"}},{default:e.withCtx((()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(o,(t=>e.createVNode(n,{key:t,label:t,value:t},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),e.createVNode(l,{id:"EnhanceExperience.switchLiveStreamQuality"})])),_:1})])),_:1}),e.createVNode(d,null,{default:e.withCtx((()=>[e.createVNode(c,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(i).banp2p.enabled,"onUpdate:modelValue":s[2]||(s[2]=t=>e.unref(i).banp2p.enabled=t),"active-text":"禁用P2P"},null,8,["modelValue"]),e.createVNode(l,{id:"EnhanceExperience.banp2p"})])),_:1})])),_:1}),e.createVNode(d,null,{default:e.withCtx((()=>[e.createVNode(c,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(i).noReport.enabled,"onUpdate:modelValue":s[3]||(s[3]=t=>e.unref(i).noReport.enabled=t),"active-text":"拦截日志数据上报"},null,8,["modelValue"]),e.createVNode(l,{id:"EnhanceExperience.noReport"})])),_:1})])),_:1}),e.createVNode(d,null,{default:e.withCtx((()=>[e.createVNode(c,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(i).noSleep.enabled,"onUpdate:modelValue":s[4]||(s[4]=t=>e.unref(i).noSleep.enabled=t),"active-text":"屏蔽挂机检测"},null,8,["modelValue"]),e.createVNode(l,{id:"EnhanceExperience.noSleep"})])),_:1})])),_:1}),e.createVNode(d,null,{default:e.withCtx((()=>[e.createVNode(c,{wrap:""},{default:e.withCtx((()=>[e.createVNode(a,{modelValue:e.unref(i).invisibility.enabled,"onUpdate:modelValue":s[5]||(s[5]=t=>e.unref(i).invisibility.enabled=t),"active-text":"隐身入场"},null,8,["modelValue"]),e.createVNode(l,{id:"EnhanceExperience.invisibility"})])),_:1})])),_:1}),e.createVNode(u)])}}}),Fe=e.defineComponent({__name:"RemoveElement",setup(t){const i=Oe().moduleConfig.RemoveElement;return(t,o)=>{const s=e.resolveComponent("el-switch"),a=e.resolveComponent("Info"),n=e.resolveComponent("el-space"),r=e.resolveComponent("el-row"),l=e.resolveComponent("el-divider");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(r,null,{default:e.withCtx((()=>[e.createVNode(n,{wrap:""},{default:e.withCtx((()=>[e.createVNode(s,{modelValue:e.unref(i).removePKBox.enabled,"onUpdate:modelValue":o[0]||(o[0]=t=>e.unref(i).removePKBox.enabled=t),"active-text":"移除大乱斗元素"},null,8,["modelValue"]),e.createVNode(a,{id:"RemoveElement.removePKBox"})])),_:1})])),_:1}),e.createVNode(r,null,{default:e.withCtx((()=>[e.createVNode(n,{wrap:""},{default:e.withCtx((()=>[e.createVNode(s,{modelValue:e.unref(i).removeLiveWaterMark.enabled,"onUpdate:modelValue":o[1]||(o[1]=t=>e.unref(i).removeLiveWaterMark.enabled=t),"active-text":"移除直播间水印"},null,8,["modelValue"]),e.createVNode(a,{id:"RemoveElement.removeLiveWaterMark"})])),_:1})])),_:1}),e.createVNode(r,null,{default:e.withCtx((()=>[e.createVNode(n,{wrap:""},{default:e.withCtx((()=>[e.createVNode(s,{modelValue:e.unref(i).removeShopPopover.enabled,"onUpdate:modelValue":o[2]||(o[2]=t=>e.unref(i).removeShopPopover.enabled=t),"active-text":"移除直播间小黄车弹窗"},null,8,["modelValue"]),e.createVNode(a,{id:"RemoveElement.removeShopPopover"})])),_:1})])),_:1}),e.createVNode(r,null,{default:e.withCtx((()=>[e.createVNode(n,{wrap:""},{default:e.withCtx((()=>[e.createVNode(s,{modelValue:e.unref(i).removeGiftPopover.enabled,"onUpdate:modelValue":o[3]||(o[3]=t=>e.unref(i).removeGiftPopover.enabled=t),"active-text":"移除礼物赠送提示弹窗"},null,8,["modelValue"]),e.createVNode(a,{id:"RemoveElement.removeGiftPopover"})])),_:1})])),_:1}),e.createVNode(r,null,{default:e.withCtx((()=>[e.createVNode(n,{wrap:""},{default:e.withCtx((()=>[e.createVNode(s,{modelValue:e.unref(i).removeGameParty.enabled,"onUpdate:modelValue":o[4]||(o[4]=t=>e.unref(i).removeGameParty.enabled=t),"active-text":"移除直播间幻星派对标志"},null,8,["modelValue"]),e.createVNode(a,{id:"RemoveElement.removeGameParty"})])),_:1})])),_:1}),e.createVNode(l)])}}}),Ge=e.defineComponent({components:{MainSiteTasks:Ae,LiveTasks:He,OtherTasks:Ue,EnhanceExperience:ze,RemoveElement:Fe}}),qe=e.defineComponent({...Ge,__name:"PanelMain",setup(t){const i=_();return(t,o)=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(i).uiConfig.activeMenuIndex)))}}),Ke=T(e.defineComponent({__name:"App",setup(t){const o=_(),s=new H("App.vue");let a,n,l=o.uiConfig.isShowPanel;function c(){const e=a.getBoundingClientRect();o.baseStyleValue.top=e.top+window.scrollY,o.baseStyleValue.left=e.left+window.scrollX,o.baseStyleValue.height=e.height,o.baseStyleValue.width=.4*e.width}o.uiConfig.isShowPanel=!1;const d=i.throttle((function(){o.changeShowPanel(),n.innerText=o.isShowPanelButtonText}),300);if(a=G("#live-player-ctnr"),a){c(),((e,t,i,o,s=!0)=>new Promise(((a,n)=>{if(s){const i=e.querySelector(t);if(i)return void a(i)}const r=setInterval((()=>{const i=e.querySelector(t);i&&(clearTimeout(r),a(i))}),i),l=setTimeout((()=>{clearTimeout(r),clearTimeout(l),n()}),o)})))(document,".left-ctnr.left-header-area",300,3e3,!0).then((e=>{var t,i;n=q("button"),n.setAttribute("class","blth_btn"),n.onclick=d,n.innerText=o.isShowPanelButtonText,e.append(n),K()||r("alt+b",{element:null==(i=null==(t=v.top)?void 0:t.document)?void 0:i.documentElement},d),r("alt+b",d)})).catch((()=>s.error("Can't find playerHeaderLeft in time"))),window.addEventListener("resize",(()=>c()));const e=new MutationObserver((()=>c()));e.observe(document.documentElement,{attributes:!0}),e.observe(document.body,{attributes:!0}),l&&(o.uiConfig.isShowPanel=!0)}else s.error("livePlayer not found");return(t,i)=>{const s=e.resolveComponent("el-header"),a=e.resolveComponent("el-aside"),n=e.resolveComponent("el-main"),r=e.resolveComponent("el-container"),l=e.resolveComponent("el-scrollbar"),c=e.resolveComponent("el-collapse-transition");return e.openBlock(),e.createBlock(c,null,{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("div",{style:e.normalizeStyle(e.unref(o).baseStyle),class:"base"},[e.createVNode(r,null,{default:e.withCtx((()=>[e.createVNode(s,{class:"header"},{default:e.withCtx((()=>[e.createVNode(b)])),_:1}),e.createVNode(l,{height:e.unref(o).scrollBarHeight},{default:e.withCtx((()=>[e.createVNode(r,null,{default:e.withCtx((()=>[e.createVNode(a,{class:"aside"},{default:e.withCtx((()=>[e.createVNode(k)])),_:1}),e.createVNode(n,{class:"main"},{default:e.withCtx((()=>[(e.openBlock(),e.createBlock(e.KeepAlive,null,[e.createVNode(e.Transition,{name:"fade",mode:"out-in"},{default:e.withCtx((()=>[e.createVNode(qe)])),_:1})],1024))])),_:1})])),_:1})])),_:1},8,["height"])])),_:1})],4),[[e.vShow,e.unref(o).uiConfig.isShowPanel]])])),_:1})}}}),[["__scopeId","data-v-d9fcd727"]]);(e=>{const t=GM_getResourceText(e);GM_addStyle(t)})("element-plus/dist/index.css");const We={},Xe={xmlns:"http://www.w3.org/2000/svg",width:"128",height:"128",class:"icon",viewBox:"0 0 1024 1024"},Je=[e.createElementVNode("path",{d:"M831.825 63.94H191.94c-70.692 0-128 57.308-128 128v639.885c0 70.692 57.308 128 128 128h639.885c70.692 0 128-57.308 128-128V191.94c0-70.692-57.308-128-128-128zM895.885 832a63.835 63.835 0 0 1-63.973 63.886H192.088c-17.112 0-33.27-6.575-45.372-18.676S127.88 849.112 127.88 832V192a64.236 64.236 0 0 1 64.208-64.12h639.824A64.038 64.038 0 0 1 895.885 192v640z"},null,-1),e.createElementVNode("path",{d:"M791.998 351.852H536a31.97 31.97 0 0 0 0 63.94h256a31.97 31.97 0 0 0 0-63.94zm0 256.121H536a31.97 31.97 0 0 0 0 63.94h256a31.97 31.97 0 0 0 0-63.94zm-447.996-79.975c-61.856 0-111.986 50.144-111.986 111.985S282.16 751.97 344.002 751.97s111.985-50.144 111.985-111.986-50.13-111.985-111.985-111.985zm33.982 145.982a48.045 48.045 0 1 1 14.088-33.982 47.746 47.746 0 0 1-14.088 33.986zm39.412-376.586L311.999 402.787l-41.391-41.395a31.97 31.97 0 1 0-45.213 45.213l63.997 64.002a31.97 31.97 0 0 0 45.214 0l128-128a31.97 31.97 0 0 0-45.21-45.213z"},null,-1)];const Qe=T(We,[["render",function(t,i){return e.openBlock(),e.createElementBlock("svg",Xe,Je)}]]),Ye={DailyTasks:{MainSiteTasks:{login:{title:"每日登录",message:"完成主站的每日登录任务。"},watch:{title:"每日观看视频",message:e.h("p",[e.h("div","完成主站的每日观看视频任务。"),e.h("div","从动态中选取视频观看，会产生观看历史记录。")])},coin:{title:"每日投币",message:e.h("p",[e.h("div","完成主站的每日投币任务。"),e.h("div","从动态中选取视频投币，会根据你今天已经投过的币的数量计算还要投几个币。")])},share:{title:"每日分享视频",message:e.h("p",[e.h("div","完成主站的每日分享视频任务。"),e.h("div","不会真的分享到某处。")])}},LiveTasks:{sign:{title:"直播签到",message:e.h("p",[e.h("div","完成直播签到任务。"),e.h("div","完成后会移除当前直播间右上角签到窗口中的签到按钮。")])},medalTasks:{list:{title:"黑白名单",message:e.h("p",[e.h("div","为更精细地控制为哪些粉丝勋章执行任务，你可以使用黑名单或白名单模式。"),e.h("div",[e.h("li",[e.h("span","黑名单：仅为"),e.h("strong","不在"),e.h("span","名单中的粉丝勋章执行任务。")]),e.h("li",[e.h("span","白名单：仅为"),e.h("strong","在"),e.h("span","名单中的粉丝勋章执行任务。")])]),e.h("div","点击编辑名单按钮，然后使用第一列的多选框即可编辑名单中的粉丝勋章。")])},like:{title:"给主播点赞",message:e.h("p",[e.h("div","在你的每个粉丝勋章对应的直播间给主播点赞。"),e.h("div",[e.h("span","如果你不希望等级≥20的粉丝勋章熄灭，可以勾选下面的“包含等级≥20的粉丝勋章”"),e.h("strong","（虽然B站的帮助中心说点赞可以点亮粉丝勋章但现在似乎不行了，所以该选项以后可能会被删除）"),e.h("span","。")]),e.h("div","部分直播间无法完成该任务，原因未知。")])},danmu:{title:"发送弹幕",message:e.h("p",[e.h("div","在你的每个粉丝勋章对应的直播间发送一条弹幕。"),e.h("div",[e.h("span","点击编辑弹幕按钮编辑发送的弹幕，脚本会从中按顺序循环抽取弹幕发送。"),e.h("span","部分直播间无法完成该任务，可能的原因有:，"),e.h("li","你被禁言了"),e.h("li","发言有粉丝勋章等级要求"),e.h("li",[e.h("span","特殊直播间（比如"),e.h("a",{href:"https://live.bilibili.com/54",rel:"noreferrer",target:"_blank"},"54"),e.h("span","）")])])])},watch:{title:"观看直播",message:e.h("p",[e.h("div","完成观看持有粉丝勋章对应主播直播的任务。"),e.h("div","部分直播间因为没有设置直播分区导致任务无法完成。主播当前是否开播不会影响该任务的完成。")])}}},OtherTasks:{groupSign:{title:"应援团签到",message:"完成应援团签到任务。"},silverToCoin:{title:"银瓜子换硬币",message:e.h("p",[e.h("div","把银瓜子兑换为硬币。"),e.h("div","具体兑换规则请点击直播间页面的“立即充值→银瓜子商店”查看。")])},coinToSilver:{title:"硬币换银瓜子",message:e.h("p",[e.h("div","把硬币兑换为银瓜子。"),e.h("div","具体兑换规则请点击直播间页面的“立即充值→银瓜子商店”查看。")])},getYearVipPrivilege:{title:"领取年度大会员权益",message:e.h("p",[e.h("div","自动领取年度大会员权益。"),e.h("div",[e.h("span","具体权益请前往"),e.h("a",{href:"https://account.bilibili.com/account/big/myPackage",rel:"noreferrer",target:"_blank"},"卡券包"),e.h("span","查看。")])])}}},EnhanceExperience:{switchLiveStreamQuality:{title:"自动切换画质",message:e.h("p",[e.h("div","打开直播间后自动把播放器切换到指定画质。"),e.h("div","如果指定画质不存在，则还是使用B站的默认画质。")])},banp2p:{title:"禁用P2P",message:e.h("p",[e.h("div","禁用直播流的P2P上传/下载"),e.h("div","B站使用WebRTC技术把许多浏览器点对点（P2P）地连接起来，实现视频流和音频流的传输。这样做是为了减轻B站服务器的压力，但是会占用你一定的上行带宽（大约几百kb每秒）。如果你不想被占用上行带宽，可以开启该功能。若开启后发现观看直播时有明显卡顿，请关闭。")])},noReport:{title:"拦截日志数据上报",message:e.h("p",[e.h("div","禁止B站上报日志数据。"),e.h("div",[e.h("span","B站会实时地上报大量日志信息，比如直播观看情况、代码报错等等。开启本功能后绝大多数日志上报都会被拦截并返回一个成功的响应。如果追求更好的效果和性能表现建议使用带有广告拦截功能的浏览器拓展，比如"),e.h("a",{href:"https://github.com/gorhill/uBlock",rel:"noreferrer",target:"_blank"},"uBlock Origin"),e.h("span","。")])])},noSleep:{title:"屏蔽挂机检测",message:e.h("p",[e.h("div","屏蔽B站直播间的挂机检测。"),e.h("div","如果长时间没有操作，会提示“检测到您已离开当前屏幕，倒计时后即将暂停播放”。开启本功能后即可避免这种情况。")])},invisibility:{title:"隐身入场",message:e.h("p",[e.h("div","进入直播间时其他人（包括主播）不会收到提示。"),e.h("div",[e.h("strong","缺点："),e.h("span","如果你拥有该直播间的粉丝勋章，本功能会导致你无法通过观看直播获取该粉丝勋章的亲密度。同时，你依然会出现在高能榜上（该问题目前无法解决）")])])}},RemoveElement:{removePKBox:{title:"移除大乱斗元素",message:"移除直播间的大乱斗元素（进度条，弹出的提示等）。"},removeLiveWaterMark:{title:"移除直播间水印",message:"移除直播画面左上角的水印。"},removeShopPopover:{title:"移除直播间小黄车弹窗",message:"移除直播间左上角的小黄车弹窗。"},removeGiftPopover:{title:"移除礼物赠送提示弹窗",message:"移除直播间右下角的礼物赠送提示弹窗（赠送一个牛蛙牛蛙支持主播）。"},removeGameParty:{title:"移除直播间幻星派对标志",message:"移除直播间右下角的幻星派对标志。"}}},Ze=(t=>(e.pushScopeId("data-v-ff60cff4"),t=t(),e.popScopeId(),t))((()=>e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",width:"128",height:"128",class:"icon",viewBox:"0 0 1024 1024"},[e.createElementVNode("path",{fill:"#276BC0",d:"M512.67 959.47c-246.343 0-446.76-200.632-446.76-447.24S266.326 64.98 512.67 64.98s446.76 200.642 446.76 447.25-200.416 447.24-446.76 447.24zm0-829.04c-210.291 0-381.38 171.283-381.38 381.8s171.089 381.79 381.38 381.79 381.381-171.273 381.381-381.79-171.09-381.8-381.38-381.8z"}),e.createElementVNode("path",{fill:"#276BC0",d:"M447.29 317.172a63.891 63.959 0 1 0 130.76 0 63.891 63.959 0 1 0-130.76 0Zm64.907 503.047c-30.093 0-54.235-24.416-54.235-54.541V482.062c0-30.126 24.142-54.541 54.235-54.541 30.094 0 54.236 24.416 54.236 54.541v283.616c0 30.125-24.142 54.54-54.236 54.54z"})],-1))),et=T(e.defineComponent({__name:"InfoIcon",props:{id:{}},setup(t){const o=t,s=()=>{const{title:e,message:t}=i.get(Ye,o.id,{title:"无",message:"无"});n.ElMessageBox({title:e,message:t,lockScroll:!1,autofocus:!0,confirmButtonText:"OK"})};return(t,i)=>{const o=e.resolveComponent("el-icon");return e.openBlock(),e.createBlock(o,{class:"info-icon",onClick:s},{default:e.withCtx((()=>[Ze])),_:1})}}}),[["__scopeId","data-v-ff60cff4"]]),tt=T(e.defineComponent({__name:"TaskStatusIcon",props:{status:{}},setup:t=>(t,i)=>{const o=e.resolveComponent("Loading"),s=e.resolveComponent("el-icon"),a=e.resolveComponent("Select"),n=e.resolveComponent("CloseBold");return"running"===t.status?(e.openBlock(),e.createBlock(s,{key:0,class:"status-icon is-loading"},{default:e.withCtx((()=>[e.createVNode(o)])),_:1})):"done"===t.status?(e.openBlock(),e.createBlock(s,{key:1,class:"status-icon",style:{color:"#1ab059"}},{default:e.withCtx((()=>[e.createVNode(a)])),_:1})):"error"===t.status?(e.openBlock(),e.createBlock(s,{key:2,class:"status-icon",style:{color:"#ff6464"}},{default:e.withCtx((()=>[e.createVNode(n)])),_:1})):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-f46b6729"]]),it=Object.freeze(Object.defineProperty({__proto__:null,Info:et,TaskStatus:tt,Tasks:Qe},Symbol.toStringTag,{value:"Module"})),ot=new H("Main");ot.log("document.readyState",document.readyState);const st=t.createPinia(),at=Ie(st),nt=Oe(st);if(at.checkCurrentScriptType(),ot.log("当前脚本的类型为",at.currentScriptType),"Main"===at.currentScriptType&&at.startMainBLTHAliveHeartBeat(),nt.loadModules("unknown"),await D("document-body"),document.head.innerHTML.includes("BilibiliLive")){const t=e.createApp(Ke);t.use(n),t.use(st);for(const[e,i]of Object.entries(c))t.component(e,i);for(const[e,i]of Object.entries(it))t.component(e,i);nt.loadModules("yes"),await D("document-end");const i=q("div");i.id="BLTH",document.body.append(i),t.mount(i)}}(Vue,Pinia,_,ElementPlusIconsVue,luxon,CryptoJS,ElementPlus,hotkeys);